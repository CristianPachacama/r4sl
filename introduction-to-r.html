<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Statistical Learning</title>
  <meta name="description" content="R for Statistical Learning">
  <meta name="generator" content="bookdown 0.3.9 and GitBook 2.6.7">

  <meta property="og:title" content="R for Statistical Learning" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://daviddalpiaz.github.io/r4sl/" />
  
  
  <meta name="github-repo" content="daviddalpiaz/r4sl" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Statistical Learning" />
  
  
  

<meta name="author" content="David Dalpiaz">


<meta name="date" content="2017-01-26">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="probability-review.html">
<link rel="next" href="rstudio-and-rmarkdown.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Statistical Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>0.1</b> About This Book</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i><b>0.2</b> Conventions</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.3</b> Acknowledgements</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>0.4</b> License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="probability-review.html"><a href="probability-review.html"><i class="fa fa-check"></i><b>1</b> Probability Review</a><ul>
<li class="chapter" data-level="1.1" data-path="probability-review.html"><a href="probability-review.html#probability-models"><i class="fa fa-check"></i><b>1.1</b> Probability Models</a></li>
<li class="chapter" data-level="1.2" data-path="probability-review.html"><a href="probability-review.html#probability-axioms"><i class="fa fa-check"></i><b>1.2</b> Probability Axioms</a></li>
<li class="chapter" data-level="1.3" data-path="probability-review.html"><a href="probability-review.html#probability-rules"><i class="fa fa-check"></i><b>1.3</b> Probability Rules</a></li>
<li class="chapter" data-level="1.4" data-path="probability-review.html"><a href="probability-review.html#random-variables"><i class="fa fa-check"></i><b>1.4</b> Random Variables</a><ul>
<li class="chapter" data-level="1.4.1" data-path="probability-review.html"><a href="probability-review.html#distributions"><i class="fa fa-check"></i><b>1.4.1</b> Distributions</a></li>
<li class="chapter" data-level="1.4.2" data-path="probability-review.html"><a href="probability-review.html#discrete-random-variables"><i class="fa fa-check"></i><b>1.4.2</b> Discrete Random Variables</a></li>
<li class="chapter" data-level="1.4.3" data-path="probability-review.html"><a href="probability-review.html#continuous-random-variables"><i class="fa fa-check"></i><b>1.4.3</b> Continuous Random Variables</a></li>
<li class="chapter" data-level="1.4.4" data-path="probability-review.html"><a href="probability-review.html#several-random-variables"><i class="fa fa-check"></i><b>1.4.4</b> Several Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="probability-review.html"><a href="probability-review.html#expectations"><i class="fa fa-check"></i><b>1.5</b> Expectations</a></li>
<li class="chapter" data-level="1.6" data-path="probability-review.html"><a href="probability-review.html#likelihood"><i class="fa fa-check"></i><b>1.6</b> Likelihood</a></li>
<li class="chapter" data-level="1.7" data-path="probability-review.html"><a href="probability-review.html#references"><i class="fa fa-check"></i><b>1.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to <code>R</code></a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-resources"><i class="fa fa-check"></i><b>2.1</b> <code>R</code> Resources</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-basics"><i class="fa fa-check"></i><b>2.2</b> <code>R</code> Basics</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-calculations"><i class="fa fa-check"></i><b>2.2.1</b> Basic Calculations</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-help"><i class="fa fa-check"></i><b>2.2.2</b> Getting Help</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-packages"><i class="fa fa-check"></i><b>2.2.3</b> Installing Packages</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.2.4</b> Data Types</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>2.2.5</b> Vectors</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#summary-statistics"><i class="fa fa-check"></i><b>2.2.6</b> Summary Statistics</a></li>
<li class="chapter" data-level="2.2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>2.2.7</b> Matrices</a></li>
<li class="chapter" data-level="2.2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>2.2.8</b> Data Frames</a></li>
<li class="chapter" data-level="2.2.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#plotting"><i class="fa fa-check"></i><b>2.2.9</b> Plotting</a></li>
<li class="chapter" data-level="2.2.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#distributions-1"><i class="fa fa-check"></i><b>2.2.10</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#programming-basics"><i class="fa fa-check"></i><b>2.3</b> Programming Basics</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#logical-operators"><i class="fa fa-check"></i><b>2.3.1</b> Logical Operators</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#control-flow"><i class="fa fa-check"></i><b>2.3.2</b> Control Flow</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.3.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#hypothesis-tests-in-r"><i class="fa fa-check"></i><b>2.4</b> Hypothesis Tests in <code>R</code></a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#one-sample-t-test-review"><i class="fa fa-check"></i><b>2.4.1</b> One Sample t-Test: Review</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#one-sample-t-test-example"><i class="fa fa-check"></i><b>2.4.2</b> One Sample t-Test: Example</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#two-sample-t-test-review"><i class="fa fa-check"></i><b>2.4.3</b> Two Sample t-Test: Review</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#two-sample-t-test-example"><i class="fa fa-check"></i><b>2.4.4</b> Two Sample t-Test: Example</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#simulation"><i class="fa fa-check"></i><b>2.5</b> Simulation</a><ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#paired-differences"><i class="fa fa-check"></i><b>2.5.1</b> Paired Differences</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#distribution-of-a-sample-mean"><i class="fa fa-check"></i><b>2.5.2</b> Distribution of a Sample Mean</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rstudio-and-rmarkdown.html"><a href="rstudio-and-rmarkdown.html"><i class="fa fa-check"></i><b>3</b> RStudio and RMarkdown</a><ul>
<li class="chapter" data-level="3.1" data-path="rstudio-and-rmarkdown.html"><a href="rstudio-and-rmarkdown.html#template"><i class="fa fa-check"></i><b>3.1</b> Template</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html"><i class="fa fa-check"></i><b>4</b> Regression Basics in <code>R</code></a><ul>
<li class="chapter" data-level="4.1" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#visualization-for-regression"><i class="fa fa-check"></i><b>4.1</b> Visualization for Regression</a></li>
<li class="chapter" data-level="4.2" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#the-lm-function"><i class="fa fa-check"></i><b>4.2</b> The <code>lm()</code> Function</a></li>
<li class="chapter" data-level="4.3" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#hypothesis-testing"><i class="fa fa-check"></i><b>4.3</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="4.4" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#prediction"><i class="fa fa-check"></i><b>4.4</b> Prediction</a></li>
<li class="chapter" data-level="4.5" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#unusual-observations"><i class="fa fa-check"></i><b>4.5</b> Unusual Observations</a></li>
<li class="chapter" data-level="4.6" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#adding-complexity"><i class="fa fa-check"></i><b>4.6</b> Adding Complexity</a><ul>
<li class="chapter" data-level="4.6.1" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#interactions"><i class="fa fa-check"></i><b>4.6.1</b> Interactions</a></li>
<li class="chapter" data-level="4.6.2" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#polynomials"><i class="fa fa-check"></i><b>4.6.2</b> Polynomials</a></li>
<li class="chapter" data-level="4.6.3" data-path="regression-basics-in-r.html"><a href="regression-basics-in-r.html#transformations"><i class="fa fa-check"></i><b>4.6.3</b> Transformations</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daviddalpiaz/r4sl" target="blank">&copy; 2017 David Dalpiaz</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Statistical Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-r" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Introduction to <code>R</code></h1>
<blockquote>
<p>“Measuring programming progress by lines of code is like measuring aircraft building progress by weight.”</p>
<p>— <strong>Bill Gates</strong></p>
</blockquote>
<p>After reading this chapter you will be able to:</p>
<ul>
<li>Interact with <code>R</code> using RStudio.</li>
<li>Use <code>R</code> as a calculator.</li>
<li>Work with data as vectors and data frames.</li>
<li>Make basic data visualizations.</li>
<li>Write your own <code>R</code> functions.</li>
<li>Perform hypothesis tests using <code>R</code>.</li>
<li>Perform basic simulations in <code>R</code>.</li>
</ul>
<div id="r-resources" class="section level2">
<h2><span class="header-section-number">2.1</span> <code>R</code> Resources</h2>
<p><code>R</code> is both a programming language and software environment for statistical computing, which is <em>free</em> and <em>open-source</em>. To get started, you will need to install two pieces of software:</p>
<ul>
<li><a href="http://cran.r-project.org/"><code>R</code>, the actual programming language.</a>
<ul>
<li>Chose your operating system, and select the most recent version, 3.3.2.</li>
</ul></li>
<li><a href="http://www.rstudio.com/">RStudio, an excellent IDE for working with <code>R</code>.</a>
<ul>
<li>Note, you must have <code>R</code> installed to use RStudio. RStudio is simply an interface used to interact with <code>R</code>.</li>
</ul></li>
</ul>
<p>The popularity of <code>R</code> is on the rise, and everyday it becomes a better tool for statistical analysis. It even generated this book! (A skill you will learn in this course.) There are many good resources for learning <code>R</code>. They are not necessary for this course, but you may find them useful if you would like a deeper understanding of <code>R</code>:</p>
<ul>
<li><a href="http://tryr.codeschool.com/">Try R</a> from Code School.
<ul>
<li>An interactive introduction to the basics of <code>R</code>. Could be very useful for getting up to speed on <code>R</code>’s syntax.</li>
</ul></li>
<li><a href="http://www.statmethods.net/">Quick-R</a> by Robert Kabacoff.
<ul>
<li>A good reference for <code>R</code> basics.</li>
</ul></li>
<li><a href="http://www.r-tutor.com/">R Tutorial</a> by Chi Yau.
<ul>
<li>A combination reference and tutorial for <code>R</code> basics.</li>
</ul></li>
<li><a href="http://rmarkdown.rstudio.com/">R Markdown</a> from RStudio.
<ul>
<li>Reference materials for RMarkdown.</li>
</ul></li>
<li><a href="https://www.nostarch.com/artofr.htm">The Art of <code>R</code> Programming</a> by Norman Matloff.
<ul>
<li>Gentle introduction to the programming side of <code>R</code>. (Whereas we will focus more on the data analysis side.) A <a href="http://vufind.carli.illinois.edu/vf-uiu/Record/uiu_6955421">free electronic version</a> is available through the Illinois library.</li>
</ul></li>
<li><a href="http://adv-r.had.co.nz/">Advanced <code>R</code></a> by Hadley Wickham.
<ul>
<li>From the author of several extremely popular <code>R</code> packages. Good follow-up to The Art of <code>R</code> Programming. (And more up-to-date material.)</li>
</ul></li>
<li><a href="http://r4ds.had.co.nz/"><code>R</code> for Data Science</a> by Hadley Wickham and Garrett Grolemund.
<ul>
<li>Similar to Advanced <code>R</code>, but focuses more on data analysis, while still introducing programming concepts. At the time of writing, currently under development.</li>
</ul></li>
<li><a href="http://www.burns-stat.com/documents/books/the-r-inferno/">The R Inferno</a> by Patrick Burns.
<ul>
<li>Likens learning the tricks of <code>R</code> to descending through the levels of hell. Very advanced material, but may be important if <code>R</code> becomes a part of your everyday toolkit.</li>
</ul></li>
</ul>
<p>RStudio has a large number of useful keyboard shortcuts. A list of these can be found using a keyboard shortcut – the keyboard shortcut to rule them all:</p>
<ul>
<li>On Windows: <code>Alt</code> + <code>Shift</code> + <code>K</code></li>
<li>On Mac: <code>Option</code> + <code>Shift</code> + <code>K</code></li>
</ul>
<p>The RStudio team has developed <a href="https://www.rstudio.com/resources/cheatsheets/">a number of “cheatsheets”</a> for working with both <code>R</code> and RStudio. <a href="http://www.rstudio.com/wp-content/uploads/2016/05/base-r.pdf">This particular cheatseet for Base <code>R</code></a> will summarize many of the concepts in this document.</p>
<p>When programming, it is often a good practice to follow a style guide. (Where do spaces go? Tabs or spaces? Underscores or CamelCase when naming variables?) No style guide is “correct” but it helps to be aware of what others do. The more import thing is to be consistent within your own code.</p>
<ul>
<li><a href="http://adv-r.had.co.nz/Style.html">Hadley Wickham Style Guide</a> from <a href="http://adv-r.had.co.nz/">Advanced <code>R</code></a></li>
<li><a href="https://google.github.io/styleguide/Rguide.xml">Google Style Guide</a></li>
</ul>
<p>For this course, our main deviation from these two guides is the use of <code>=</code> in place of <code>&lt;-</code>. (More on that later.)</p>
</div>
<div id="r-basics" class="section level2">
<h2><span class="header-section-number">2.2</span> <code>R</code> Basics</h2>
<div id="basic-calculations" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Basic Calculations</h3>
<p>To get started, we’ll use <code>R</code> like a simple calculator.</p>
<div id="addition-subtraction-multiplication-and-division" class="section level4 unnumbered">
<h4>Addition, Subtraction, Multiplication and Division</h4>
<table>
<thead>
<tr class="header">
<th align="left">Math</th>
<th align="left"><code>R</code></th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(3 + 2\)</span></td>
<td align="left"><code>3 + 2</code></td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(3 - 2\)</span></td>
<td align="left"><code>3 - 2</code></td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(3 \cdot2\)</span></td>
<td align="left"><code>3 * 2</code></td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(3 / 2\)</span></td>
<td align="left"><code>3 / 2</code></td>
<td align="left">1.5</td>
</tr>
</tbody>
</table>
</div>
<div id="exponents" class="section level4 unnumbered">
<h4>Exponents</h4>
<table>
<thead>
<tr class="header">
<th align="left">Math</th>
<th align="left"><code>R</code></th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(3^2\)</span></td>
<td align="left"><code>3 ^ 2</code></td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(2^{(-3)}\)</span></td>
<td align="left"><code>2 ^ (-3)</code></td>
<td align="left">0.125</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(100^{1/2}\)</span></td>
<td align="left"><code>100 ^ (1 / 2)</code></td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sqrt{100}\)</span></td>
<td align="left"><code>sqrt(100)</code></td>
<td align="left">10</td>
</tr>
</tbody>
</table>
</div>
<div id="mathematical-constants" class="section level4 unnumbered">
<h4>Mathematical Constants</h4>
<table>
<thead>
<tr class="header">
<th align="left">Math</th>
<th align="left"><code>R</code></th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\pi\)</span></td>
<td align="left"><code>pi</code></td>
<td align="left">3.1415927</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(e\)</span></td>
<td align="left"><code>exp(1)</code></td>
<td align="left">2.7182818</td>
</tr>
</tbody>
</table>
</div>
<div id="logarithms" class="section level4 unnumbered">
<h4>Logarithms</h4>
<p>Note that we will use <span class="math inline">\(\ln\)</span> and <span class="math inline">\(\log\)</span> interchangeably to mean the natural logarithm. There is no <code>ln()</code> in <code>R</code>, instead it uses <code>log()</code> to mean the natural logarithm.</p>
<table>
<thead>
<tr class="header">
<th align="left">Math</th>
<th align="left"><code>R</code></th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\log(e)\)</span></td>
<td align="left"><code>log(exp(1))</code></td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\log_{10}(1000)\)</span></td>
<td align="left"><code>log10(1000)</code></td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\log_{2}(8)\)</span></td>
<td align="left"><code>log2(8)</code></td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\log_{4}(16)\)</span></td>
<td align="left"><code>log(16, base = 4)</code></td>
<td align="left">2</td>
</tr>
</tbody>
</table>
</div>
<div id="trigonometry" class="section level4 unnumbered">
<h4>Trigonometry</h4>
<table>
<thead>
<tr class="header">
<th align="left">Math</th>
<th align="left"><code>R</code></th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\sin(\pi / 2)\)</span></td>
<td align="left"><code>sin(pi / 2)</code></td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\cos(0)\)</span></td>
<td align="left"><code>cos(0)</code></td>
<td align="left">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="getting-help" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Getting Help</h3>
<p>In using <code>R</code> as a calculator, we have seen a number of functions: <code>sqrt()</code>, <code>exp()</code>, <code>log()</code> and <code>sin()</code>. To get documentation about a function in <code>R</code>, simply put a question mark in front of the function name and RStudio will display the documentation, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?log
?sin
?paste
?lm</code></pre></div>
<p>Frequently one of the most difficult things to do when learning <code>R</code> is asking for help. First, you need to decide to ask for help, then you need to know <em>how</em> to ask for help. Your very first line of defense should be to Google your error message or a short description of your issue. (The ability to solve problems using this method is quickly becoming an extremely valuable skill.) If that fails, and it eventually will, you should ask for help. There are a number of things you should include when emailing an instructor, or posting to a help website such as <a href="http://stats.stackexchange.com/">Stack Exchange</a>.</p>
<ul>
<li>Describe what you expect the code to do.</li>
<li>State the end goal you are trying to achieve. (Sometimes what you expect the code to do, is not what you want to actually do.)</li>
<li>Provide the full text of any errors you have received.</li>
<li>Provide enough code to recreate the error. Often for the purpose of this course, you could simply email your entire <code>.R</code> or <code>.Rmd</code> file.</li>
<li>Sometimes it is also helpful to include a screenshot of your entire RStudio window when the error occurs.</li>
</ul>
<p>If you follow these steps, you will get your issue resolved much quicker, and possibly learn more in the process. Do not be discouraged by running into errors and difficulties when learning <code>R</code>. (Or any technical skill.) It is simply part of the learning process.</p>
</div>
<div id="installing-packages" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Installing Packages</h3>
<p><code>R</code> comes with a number of built-in functions and datasets, but one of the main strengths of <code>R</code> as an open-source project is its package system. Packages add additional functions and data. Frequently if you want to do something in <code>R</code>, and it isn’t available by default, there is a good chance that there is a package that will fulfill your needs.</p>
<p>To install a package, use the <code>install.packages()</code> function. Think of this as buying a recipe book from the store, bringing it home, and putting it on your shelf.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</code></pre></div>
<p>Once a package is installed, it must be loaded into your current <code>R</code> session before being used. Think of this as taking the book off of the shelf and opening it up to read.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
<p>Once you close <code>R</code>, all the packages are closed and put back on the imaginary shelf. The next time you open <code>R</code>, you do not have to install the package again, but you do have to load any packages you intend to use by invoking <code>library()</code>.</p>
</div>
<div id="data-types" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Data Types</h3>
<p><code>R</code> has a number of basic data <em>types</em>.</p>
<ul>
<li>Numeric
<ul>
<li>Also known as Double. The default type when dealing with numbers.</li>
<li>Examples: <code>1</code>, <code>1.0</code>, <code>42.5</code></li>
</ul></li>
<li>Integer
<ul>
<li>Examples: <code>1L</code>, <code>2L</code>, <code>42L</code></li>
</ul></li>
<li>Complex
<ul>
<li>Example: <code>4 + 2i</code></li>
</ul></li>
<li>Logical
<ul>
<li>Two possible values: <code>TRUE</code> and <code>FALSE</code></li>
<li>You can also use <code>T</code> and <code>F</code>, but this is <em>not</em> recommended.</li>
<li><code>NA</code> is also considered logical.</li>
</ul></li>
<li>Character
<ul>
<li>Examples: <code>&quot;a&quot;</code>, <code>&quot;Statistics&quot;</code>, <code>&quot;1 plus 2.&quot;</code></li>
</ul></li>
</ul>
<p><code>R</code> also has a number of basic data <em>structures</em>. A data structure is either homogeneous (all elements are of the same data type) or heterogeneous (elements can be of more than one data type).</p>
<table>
<thead>
<tr class="header">
<th align="left">Dimension</th>
<th align="left"><strong>Homogeneous</strong></th>
<th align="left"><strong>Heterogeneous</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Vector</td>
<td align="left">List</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">Matrix</td>
<td align="left">Data Frame</td>
</tr>
<tr class="odd">
<td align="left">3+</td>
<td align="left">Array</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div id="vectors" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Vectors</h3>
<p>Many operations in <code>R</code> make heavy use of <strong>vectors</strong>. Vectors in <code>R</code> are indexed starting at <code>1</code>. That is what the <code>[1]</code> in the output is indicating, that the first element of the row being displayed is the first element of the vector. Larger vectors will start additional rows with <code>[*]</code> where <code>*</code> is the index of the first element of the row.</p>
<p>Possibly the most common way to create a vector in <code>R</code> is using the <code>c()</code> function, which is short for “combine.”&quot; As the name suggests, it combines a list of numbers separated by commas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</code></pre></div>
<pre><code>## [1] 1 3 5 7 8 9</code></pre>
<p>Here <code>R</code> simply outputs this vector. If we would like to store this vector in a <strong>variable</strong> we can do so with the <strong>assignment</strong> operator <code>=</code>. In this case the variable <code>x</code> now holds the vector we just created, and we can access the vector by typing <code>x</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)
x</code></pre></div>
<pre><code>## [1] 1 3 5 7 8 9</code></pre>
<p>As an aside, there is a long history of the assignment operator in <code>R</code>, partially due to the keys available on the <a href="https://twitter.com/kwbroman/status/747829864091127809">keyboards of the creators of the <code>S</code> language.</a> (Which preceded <code>R</code>.) For simplicity we will use <code>=</code>, but know that often you will see <code>&lt;-</code> as the assignment operator.</p>
<p>The pros and cons of these two are well beyond the scope of this book, but know that for our purposes you will have no issue if you simply use <code>=</code>. If you are interested in the weird cases where the difference matters, check out <a href="http://www.burns-stat.com/documents/books/the-r-inferno/">The R Inferno</a>.</p>
<p>If you wish to use <code>&lt;-</code>, you will still need to use <code>=</code>, however only for argument passing. Some users like to keep assignment (<code>&lt;-</code>) and argument passing (<code>=</code>) separate. No matter what you choose, the more important thing is that you <strong>stay consistent</strong>. Also, if working on a larger collaborative project, you should use whatever style is already in place.</p>
<p>Frequently you may wish to create a vector based on a sequence of numbers. The quickest and easiest way to do this is with the <code>:</code> operator, which creates a sequence of integers between two specified integers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">y =</span> <span class="dv">1</span>:<span class="dv">100</span>)</code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
##  [18]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34
##  [35]  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51
##  [52]  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68
##  [69]  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85
##  [86]  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100</code></pre>
<p>Here we see <code>R</code> labeling the rows after the first since this is a large vector. Also, we see that by putting parentheses around the assignment, <code>R</code> both stores the vector in a variable called <code>y</code> and automatically outputs <code>y</code> to the console.</p>
<p>To subset a vector, we use square brackets, <code>[]</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x</code></pre></div>
<pre><code>## [1] 1 3 5 7 8 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="dv">1</span>]</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>We see that <code>x[1]</code> returns the first element, and <code>x[3]</code> returns the third element.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[-<span class="dv">2</span>]</code></pre></div>
<pre><code>## [1] 1 5 7 8 9</code></pre>
<p>We can also exclude certain indexes, in this case the second element.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="dv">1</span>:<span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] 1 3 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</code></pre></div>
<pre><code>## [1] 1 5 7</code></pre>
<p>Lastly we see that we can subset based on a vector of indices.</p>
<p>One of the biggest strengths of <code>R</code> is its use of vectorized operations. (Frequently the lack of understanding of this concept leads of a belief that <code>R</code> is <em>slow</em>. <code>R</code> is not the fastest language, but it has a reputation for being slower than it really is.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
x +<span class="st"> </span><span class="dv">1</span></code></pre></div>
<pre><code>##  [1]  2  3  4  5  6  7  8  9 10 11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span> *<span class="st"> </span>x</code></pre></div>
<pre><code>##  [1]  2  4  6  8 10 12 14 16 18 20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span> ^<span class="st"> </span>x</code></pre></div>
<pre><code>##  [1]    2    4    8   16   32   64  128  256  512 1024</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>(x)</code></pre></div>
<pre><code>##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751
##  [8] 2.828427 3.000000 3.162278</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">log</span>(x)</code></pre></div>
<pre><code>##  [1] 0.0000000 0.6931472 1.0986123 1.3862944 1.6094379 1.7917595 1.9459101
##  [8] 2.0794415 2.1972246 2.3025851</code></pre>
<p>We see that when a function like <code>log()</code> is called on a vector <code>x</code>, a vector is returned which has applied the function to each element of the vector <code>x</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vec_1 =<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
vec_2 =<span class="st"> </span><span class="dv">1</span>:<span class="dv">1000</span>
vec_3 =<span class="st"> </span><span class="dv">42</span></code></pre></div>
<p>The length of a vector can be obtained with the <code>length()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(vec_1)</code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(vec_2)</code></pre></div>
<pre><code>## [1] 1000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(vec_3)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Note that scalars do not exists in <code>R</code>. They are simply vectors of length <code>1</code>.</p>
<p>If we want to create a sequence that isn’t limited to integers and increasing by 1 at a time, we can use the <code>seq()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">1.5</span>, <span class="dt">to =</span> <span class="fl">4.2</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##  [1] 1.5 1.6 1.7 1.8 1.9 2.0 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 3.0 3.1
## [18] 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 4.0 4.1 4.2</code></pre>
<p>We will discuss functions in detail later, but note here that the input labels <code>from</code>, <code>to</code>, and <code>by</code> are optional.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">seq</span>(<span class="fl">1.5</span>, <span class="fl">4.2</span>, <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##  [1] 1.5 1.6 1.7 1.8 1.9 2.0 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 3.0 3.1
## [18] 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 4.0 4.1 4.2</code></pre>
<p>Another common operation to create a vector is <code>rep()</code>, which can repeat a single value a number of times.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dt">times =</span> <span class="dv">10</span>)</code></pre></div>
<pre><code>##  [1] &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot;</code></pre>
<p>Or, <code>rep()</code> can be used to repeat a vector a number of times.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(x, <span class="dt">times =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10  1  2  3  4  5  6  7  8  9 10  1  2  3
## [24]  4  5  6  7  8  9 10</code></pre>
<p>We have now seen four different ways to create vectors:</p>
<ul>
<li><code>c()</code></li>
<li><code>:</code></li>
<li><code>seq()</code></li>
<li><code>rep()</code></li>
</ul>
<p>So far we have mostly used them in isolation, but they are often used together.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(x, <span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">2</span>), <span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dv">42</span>, <span class="dv">2</span>:<span class="dv">4</span>)</code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10  1  3  5  7  9  1  3  5  7  9  1  3  5
## [24]  7  9  1  2  3 42  2  3  4</code></pre>
</div>
<div id="summary-statistics" class="section level3">
<h3><span class="header-section-number">2.2.6</span> Summary Statistics</h3>
<p><code>R</code> has built in functions for a large number of summary statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y</code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
##  [18]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34
##  [35]  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51
##  [52]  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68
##  [69]  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85
##  [86]  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100</code></pre>
<div id="central-tendency" class="section level4 unnumbered">
<h4>Central Tendency</h4>
<table>
<thead>
<tr class="header">
<th align="left">Measure</th>
<th align="left"><code>R</code></th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="left"><code>mean(y)</code></td>
<td align="left">50.5</td>
</tr>
<tr class="even">
<td align="left">Median</td>
<td align="left"><code>median(y)</code></td>
<td align="left">50.5</td>
</tr>
</tbody>
</table>
</div>
<div id="spread" class="section level4 unnumbered">
<h4>Spread</h4>
<table>
<thead>
<tr class="header">
<th align="left">Measure</th>
<th align="left"><code>R</code></th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Variance</td>
<td align="left"><code>var(y)</code></td>
<td align="left">841.6666667</td>
</tr>
<tr class="even">
<td align="left">Standard Deviation</td>
<td align="left"><code>sd(y)</code></td>
<td align="left">29.011492</td>
</tr>
<tr class="odd">
<td align="left">IQR</td>
<td align="left"><code>IQR(y)</code></td>
<td align="left">49.5</td>
</tr>
<tr class="even">
<td align="left">Minimum</td>
<td align="left"><code>min(y)</code></td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">Maximum</td>
<td align="left"><code>max(y)</code></td>
<td align="left">100</td>
</tr>
<tr class="even">
<td align="left">Range</td>
<td align="left"><code>range(y)</code></td>
<td align="left">1, 100</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="matrices" class="section level3">
<h3><span class="header-section-number">2.2.7</span> Matrices</h3>
<p><code>R</code> can also be used for <strong>matrix</strong> calculations. Matrices have rows and columns containing a single data type. In a matrix, the order of rows and columns is important. (This is not true of <em>data frames</em>, which we will see later.)</p>
<p>Matrices can be created using the <code>matrix</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="dv">1</span>:<span class="dv">9</span>
x</code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6 7 8 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X =<span class="st"> </span><span class="kw">matrix</span>(x, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)
X</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<p>Note here that we are using two different variables: lower case <code>x</code>, which stores a vector and capital <code>X</code>, which stores a matrix. (Following the usual mathematical convention.) We can do this because <code>R</code> is case sensitive.</p>
<p>By default the <code>matrix</code> function reorders a vector into columns, but we can also tell <code>R</code> to use rows instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Y =<span class="st"> </span><span class="kw">matrix</span>(x, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
Y</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    7    8    9</code></pre>
<p>We can also create a matrix of a specified dimension where every element is the same, in this case <code>0</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Z =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>)
Z</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0    0
## [2,]    0    0    0    0</code></pre>
<p>Like vectors, matrices can be subsetted using square brackets, <code>[]</code>. However, since matrices are two-dimensional, we need to specify both a row and a column when subsetting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X[<span class="dv">1</span>, <span class="dv">2</span>]</code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Here we accessed the element in the first row and the second column. We could also subset an entire row or column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X[<span class="dv">1</span>, ]</code></pre></div>
<pre><code>## [1] 1 4 7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X[, <span class="dv">2</span>]</code></pre></div>
<pre><code>## [1] 4 5 6</code></pre>
<p>We can also use vectors to subset more than one row or column at a time. Here we subset to the first and third column of the second row.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X[<span class="dv">2</span>, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</code></pre></div>
<pre><code>## [1] 2 8</code></pre>
<p>Matrices can also be created by combining vectors as columns, using <code>cbind</code>, or combining vectors as rows, using <code>rbind</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="dv">1</span>:<span class="dv">9</span>
<span class="kw">rev</span>(x)</code></pre></div>
<pre><code>## [1] 9 8 7 6 5 4 3 2 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>)</code></pre></div>
<pre><code>## [1] 1 1 1 1 1 1 1 1 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(x, <span class="kw">rev</span>(x), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>))</code></pre></div>
<pre><code>##       x    
##  [1,] 1 9 1
##  [2,] 2 8 1
##  [3,] 3 7 1
##  [4,] 4 6 1
##  [5,] 5 5 1
##  [6,] 6 4 1
##  [7,] 7 3 1
##  [8,] 8 2 1
##  [9,] 9 1 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rbind</span>(x, <span class="kw">rev</span>(x), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>))</code></pre></div>
<pre><code>##   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
## x    1    2    3    4    5    6    7    8    9
##      9    8    7    6    5    4    3    2    1
##      1    1    1    1    1    1    1    1    1</code></pre>
<p><code>R</code> can then be used to perform matrix calculations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="dv">1</span>:<span class="dv">9</span>
y =<span class="st"> </span><span class="dv">9</span>:<span class="dv">1</span>
X =<span class="st"> </span><span class="kw">matrix</span>(x, <span class="dv">3</span>, <span class="dv">3</span>)
Y =<span class="st"> </span><span class="kw">matrix</span>(y, <span class="dv">3</span>, <span class="dv">3</span>)
X</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Y</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    9    6    3
## [2,]    8    5    2
## [3,]    7    4    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X +<span class="st"> </span>Y</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   10   10   10
## [2,]   10   10   10
## [3,]   10   10   10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X -<span class="st"> </span>Y</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -8   -2    4
## [2,]   -6    0    6
## [3,]   -4    2    8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X *<span class="st"> </span>Y</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    9   24   21
## [2,]   16   25   16
## [3,]   21   24    9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X /<span class="st"> </span>Y</code></pre></div>
<pre><code>##           [,1]      [,2]     [,3]
## [1,] 0.1111111 0.6666667 2.333333
## [2,] 0.2500000 1.0000000 4.000000
## [3,] 0.4285714 1.5000000 9.000000</code></pre>
<p>Note that <code>X * Y</code> is not matrix multiplication. It is element by element multiplication. (Same for <code>X / Y</code>). Instead, matrix multiplication uses <code>%*%</code>. Other matrix functions include <code>t()</code> which gives the transpose of a matrix and <code>solve()</code> which returns the inverse of a square matrix if it is invertible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X %*%<span class="st"> </span>Y</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   90   54   18
## [2,]  114   69   24
## [3,]  138   84   30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t</span>(X)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    7    8    9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Z =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">2</span>, -<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, -<span class="dv">2</span>, -<span class="dv">3</span>, -<span class="dv">2</span>, <span class="dv">16</span>), <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
Z</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    9    2   -3
## [2,]    2    4   -2
## [3,]   -3   -2   16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">solve</span>(Z)</code></pre></div>
<pre><code>##             [,1]        [,2]       [,3]
## [1,]  0.12931034 -0.05603448 0.01724138
## [2,] -0.05603448  0.29094828 0.02586207
## [3,]  0.01724138  0.02586207 0.06896552</code></pre>
<p><code>R</code> has a number of matrix specific functions for obtaining dimension and summary information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">3</span>)
X</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(X)</code></pre></div>
<pre><code>## [1] 2 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rowSums</span>(X)</code></pre></div>
<pre><code>## [1]  9 12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(X)</code></pre></div>
<pre><code>## [1]  3  7 11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rowMeans</span>(X)</code></pre></div>
<pre><code>## [1] 3 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colMeans</span>(X)</code></pre></div>
<pre><code>## [1] 1.5 3.5 5.5</code></pre>
<p>The <code>diag()</code> function can be used in a number of ways. We can extract the diagonal of a matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag</span>(Z)</code></pre></div>
<pre><code>## [1]  9  4 16</code></pre>
<p>Or create a matrix with specified elements on the diagonal. (And <code>0</code> on the off-diagonals.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag</span>(<span class="dv">1</span>:<span class="dv">5</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    2    0    0    0
## [3,]    0    0    3    0    0
## [4,]    0    0    0    4    0
## [5,]    0    0    0    0    5</code></pre>
<p>Or, lastly, create a square matrix of a certain dimension with <code>1</code> for every element of the diagonal and <code>0</code> for the off-diagonals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag</span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0    0    1    0    0
## [4,]    0    0    0    1    0
## [5,]    0    0    0    0    1</code></pre>
<div id="calculations-with-vectors-and-matrices" class="section level4 unnumbered">
<h4>Calculations with Vectors and Matrices</h4>
<p>Certain operations in <code>R</code>, for example <code>%*%</code> have different behavior on vectors and matrices. To illustrate this, we will first create two vectors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a_vec =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)
b_vec =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</code></pre></div>
<p>Note that these are indeed vectors. They are not matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">is.vector</span>(a_vec), <span class="kw">is.vector</span>(b_vec))</code></pre></div>
<pre><code>## [1] TRUE TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">is.matrix</span>(a_vec), <span class="kw">is.matrix</span>(b_vec))</code></pre></div>
<pre><code>## [1] FALSE FALSE</code></pre>
<p>When this is the case, the <code>%*%</code> operator is used to calculate the <strong>dot product</strong>, also know as the <strong>inner product</strong> of the two vectors.</p>
<p>The dot product of vectors <span class="math inline">\(\boldsymbol{a} = \lbrack a_1, a_2, \cdots a_n \rbrack\)</span> and <span class="math inline">\(\boldsymbol{b} = \lbrack b_1, b_2, \cdots b_n \rbrack\)</span> is defined to be</p>
<p><span class="math display">\[
\boldsymbol{a} \cdot \boldsymbol{b} = \sum_{i = 1}^{n} a_i b_i = a_1 b_1 + a_2 b_2 + \cdots a_n b_n.
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a_vec %*%<span class="st"> </span>b_vec <span class="co"># inner product</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a_vec %o%<span class="st"> </span>b_vec <span class="co"># outer product</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2    2    2
## [2,]    4    4    4
## [3,]    6    6    6</code></pre>
<p>The <code>%o%</code> operator is used to calculate the <strong>outer product</strong> of the two vectors.</p>
<p>When vectors are coerced to become matrices, they are column vectors. So a vector of length <span class="math inline">\(n\)</span> becomes an <span class="math inline">\(n \times 1\)</span> matrix after coercion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.matrix</span>(a_vec)</code></pre></div>
<pre><code>##      [,1]
## [1,]    1
## [2,]    2
## [3,]    3</code></pre>
<p>If we use the <code>%*%</code> operator on matrices, <code>%*%</code> again performs the expected matrix multiplication. So you might expect the following to produce an error, because the dimensions are incorrect.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.matrix</span>(a_vec) %*%<span class="st"> </span>b_vec</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2    2    2
## [2,]    4    4    4
## [3,]    6    6    6</code></pre>
<p>At face value this is a <span class="math inline">\(3 \times 1\)</span> matrix, multiplied by a <span class="math inline">\(3 \times 1\)</span> matrix. However, when <code>b_vec</code> is automatically coerced to be a matrix, <code>R</code> decided to make it a “row vector”, a <span class="math inline">\(1 \times 3\)</span> matrix, so that the multiplication has conformable dimensions.</p>
<p>If we had coerced both, then <code>R</code> would produce an error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.matrix</span>(a_vec) %*%<span class="st"> </span><span class="kw">as.matrix</span>(b_vec)</code></pre></div>
<p>Another way to calculate a <em>dot product</em> is with the <code>crossprod()</code> function. Given two vectors, the <code>crossprod()</code> function calculates their dot product. The function has a rather misleading name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">crossprod</span>(a_vec, b_vec)  <span class="co"># inner product</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tcrossprod</span>(a_vec, b_vec)  <span class="co"># outer product</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2    2    2
## [2,]    4    4    4
## [3,]    6    6    6</code></pre>
<p>These functions could be very useful later. When used with matrices <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as arguments, it calculates</p>
<p><span class="math display">\[
X^\top Y.
\]</span></p>
<p>When dealing with linear models, the calculation</p>
<p><span class="math display">\[
X^\top X
\]</span></p>
<p>is used repeatedly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">C_mat =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="dv">2</span>, <span class="dv">3</span>)
D_mat =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">3</span>)</code></pre></div>
<p>This is useful both as a shortcut for a frequent calculation and as a more efficient implementation than using <code>t()</code> and <code>%*%</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">crossprod</span>(C_mat, D_mat)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    6    6    6
## [2,]   14   14   14
## [3,]   22   22   22</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t</span>(C_mat) %*%<span class="st"> </span>D_mat</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    6    6    6
## [2,]   14   14   14
## [3,]   22   22   22</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(<span class="kw">crossprod</span>(C_mat, D_mat), <span class="kw">t</span>(C_mat) %*%<span class="st"> </span>D_mat)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">crossprod</span>(C_mat, C_mat)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    5   11   17
## [2,]   11   25   39
## [3,]   17   39   61</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t</span>(C_mat) %*%<span class="st"> </span>C_mat</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    5   11   17
## [2,]   11   25   39
## [3,]   17   39   61</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(<span class="kw">crossprod</span>(C_mat, C_mat), <span class="kw">t</span>(C_mat) %*%<span class="st"> </span>C_mat)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="data-frames" class="section level3">
<h3><span class="header-section-number">2.2.8</span> Data Frames</h3>
<p>We have previously seen vectors and matrices for storing data as we introduced <code>R</code>. We will now introduce a <strong>data frame</strong> which will be the most common way that we store and interact with data in this course.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_data =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>),
                          <span class="dt">y =</span> <span class="kw">rep</span>(<span class="st">&quot;Hello&quot;</span>, <span class="dv">10</span>),
                          <span class="dt">z =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>), <span class="dv">5</span>))</code></pre></div>
<p>Unlike a matrix, which can be thought of as a vector rearranged into rows and columns, a data frame is not required to have the same data type for each element. A data frame is a <strong>list</strong> of vectors. So, each vector must contain the same data type, but the different vectors can store different data types.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_data</code></pre></div>
<pre><code>##    x     y     z
## 1  1 Hello  TRUE
## 2  3 Hello FALSE
## 3  5 Hello  TRUE
## 4  7 Hello FALSE
## 5  9 Hello  TRUE
## 6  1 Hello FALSE
## 7  3 Hello  TRUE
## 8  5 Hello FALSE
## 9  7 Hello  TRUE
## 10 9 Hello FALSE</code></pre>
<p>The <code>data.frame()</code> function above is one way to create a data frame. We can also import data from various file types in into <code>R</code>, as well as use data stored in packages.</p>
<p><a href="data/example_data.csv">The example data above can also be found here as a .csv file.</a> To read this data into <code>R</code>, we would use the <code>read_csv()</code> function from the <code>readr</code> package. Note that <code>R</code> has a built in function <code>read.csv()</code> that operates very similarly. The <code>readr</code> function <code>read_csv()</code> has a number of advantages. For example, it is much faster reading larger data. <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">It also uses the <code>tibble</code> package to read the data as a tibble.</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
example_data_from_csv =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/example_data.csv&quot;</span>)</code></pre></div>
<p>This particular line of code assumes that the file <code>example_data.csv</code> exists in a folder called <code>data</code> in your current working directory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example_data_from_csv</code></pre></div>
<pre><code>## # A tibble: 10 × 3
##        x     y     z
##    &lt;int&gt; &lt;chr&gt; &lt;lgl&gt;
## 1      1 Hello  TRUE
## 2      3 Hello FALSE
## 3      5 Hello  TRUE
## 4      7 Hello FALSE
## 5      9 Hello  TRUE
## 6      1 Hello FALSE
## 7      3 Hello  TRUE
## 8      5 Hello FALSE
## 9      7 Hello  TRUE
## 10     9 Hello FALSE</code></pre>
<p>A tibble is simply a data frame that prints with sanity. Notice in the output above that we are given additional information such as dimension and variable type.</p>
<p>The <code>as_tibble()</code> function can be used to coerce a regular data frame to a tibble.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tibble)
example_data =<span class="st"> </span><span class="kw">as_tibble</span>(example_data)
example_data</code></pre></div>
<pre><code>## # A tibble: 10 × 3
##        x      y      z
##    &lt;dbl&gt; &lt;fctr&gt; &lt;fctr&gt;
## 1      1  Hello   TRUE
## 2      3  Hello  FALSE
## 3      5  Hello   TRUE
## 4      7  Hello  FALSE
## 5      9  Hello   TRUE
## 6      1  Hello  FALSE
## 7      3  Hello   TRUE
## 8      5  Hello  FALSE
## 9      7  Hello   TRUE
## 10     9  Hello  FALSE</code></pre>
<p>Alternatively, we could use the “Import Dataset” feature in RStudio which can be found in the environment window. (By default, the top-right pane of RStudio.) Once completed, this process will automatically generate the code to import a file. The resulting code will be shown in the console window. In recent versions of RStudio, <code>read_csv()</code> is used by default, thus reading in a tibble.</p>
<p>Earlier we looked at installing packages, in particular the <code>ggplot2</code> package. (A package for visualization. While not necessary for this course, it is quickly growing in popularity.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
<p>Inside the <code>ggplot2</code> package is a dataset called <code>mpg</code>. By loading the package using the <code>library()</code> function, we can now access <code>mpg</code>.</p>
<p>When using data from inside a package, there are three things we would generally like to do:</p>
<ul>
<li>Look at the raw data.</li>
<li>Understand the data. (Where did it come from? What are the variables? Etc.)</li>
<li>Visualize the data.</li>
</ul>
<p>To look at the data, we have two useful commands: <code>head()</code> and <code>str()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mpg, <span class="dt">n =</span> <span class="dv">10</span>)</code></pre></div>
<pre><code>## # A tibble: 10 × 11
##    manufacturer      model displ  year   cyl      trans   drv   cty   hwy
##           &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;      &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
## 1          audi         a4   1.8  1999     4   auto(l5)     f    18    29
## 2          audi         a4   1.8  1999     4 manual(m5)     f    21    29
## 3          audi         a4   2.0  2008     4 manual(m6)     f    20    31
## 4          audi         a4   2.0  2008     4   auto(av)     f    21    30
## 5          audi         a4   2.8  1999     6   auto(l5)     f    16    26
## 6          audi         a4   2.8  1999     6 manual(m5)     f    18    26
## 7          audi         a4   3.1  2008     6   auto(av)     f    18    27
## 8          audi a4 quattro   1.8  1999     4 manual(m5)     4    18    26
## 9          audi a4 quattro   1.8  1999     4   auto(l5)     4    16    25
## 10         audi a4 quattro   2.0  2008     4 manual(m6)     4    20    28
## # ... with 2 more variables: fl &lt;chr&gt;, class &lt;chr&gt;</code></pre>
<p>The function <code>head()</code> will display the first <code>n</code> observations of the data frame. The <code>head()</code> function was more useful before tibbles. Notice that <code>mpg</code> is a tibble already, so the output from <code>head()</code> indicates there are only <code>10</code> observations. Note that this applies to <code>head(mpg, n = 10)</code> and not <code>mpg</code> itself. Also note that tibbles print a limited number of rows and columns by default. The last line of the printed output indicates with rows and columns were omitted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mpg</code></pre></div>
<pre><code>## # A tibble: 234 × 11
##    manufacturer      model displ  year   cyl      trans   drv   cty   hwy
##           &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;      &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
## 1          audi         a4   1.8  1999     4   auto(l5)     f    18    29
## 2          audi         a4   1.8  1999     4 manual(m5)     f    21    29
## 3          audi         a4   2.0  2008     4 manual(m6)     f    20    31
## 4          audi         a4   2.0  2008     4   auto(av)     f    21    30
## 5          audi         a4   2.8  1999     6   auto(l5)     f    16    26
## 6          audi         a4   2.8  1999     6 manual(m5)     f    18    26
## 7          audi         a4   3.1  2008     6   auto(av)     f    18    27
## 8          audi a4 quattro   1.8  1999     4 manual(m5)     4    18    26
## 9          audi a4 quattro   1.8  1999     4   auto(l5)     4    16    25
## 10         audi a4 quattro   2.0  2008     4 manual(m6)     4    20    28
## # ... with 224 more rows, and 2 more variables: fl &lt;chr&gt;, class &lt;chr&gt;</code></pre>
<p>The function <code>str()</code> will display the “structure” of the data frame. It will display the number of <strong>observations</strong> and <strong>variables</strong>, list the variables, give the type of each variable, and show some elements of each variable. This information can also be found in the “Environment” window in RStudio.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(mpg)</code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    234 obs. of  11 variables:
##  $ manufacturer: chr  &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; ...
##  $ model       : chr  &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; ...
##  $ displ       : num  1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...
##  $ year        : int  1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...
##  $ cyl         : int  4 4 4 4 6 6 6 4 4 4 ...
##  $ trans       : chr  &quot;auto(l5)&quot; &quot;manual(m5)&quot; &quot;manual(m6)&quot; &quot;auto(av)&quot; ...
##  $ drv         : chr  &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; ...
##  $ cty         : int  18 21 20 21 16 18 18 18 16 20 ...
##  $ hwy         : int  29 29 31 30 26 26 27 26 25 28 ...
##  $ fl          : chr  &quot;p&quot; &quot;p&quot; &quot;p&quot; &quot;p&quot; ...
##  $ class       : chr  &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; ...</code></pre>
<p>It is important to note that while matrices have rows and columns, data frames (tibbles) instead have observations and variables. When displayed in the console or viewer, each row is an observation and each column is a variable. However generally speaking, their order does not matter, it is simply a side-effect of how the data was entered or stored.</p>
<p>In this dataset an observation is for a particular model-year of a car, and the variables describe attributes of the car, for example its highway fuel efficiency.</p>
<p>To understand more about the data set, we use the <code>?</code> operator to pull up the documentation for the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?mpg</code></pre></div>
<p><code>R</code> has a number of functions for quickly working with and extracting basic information from data frames. To quickly obtain a vector of the variable names, we use the <code>names()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(mpg)</code></pre></div>
<pre><code>##  [1] &quot;manufacturer&quot; &quot;model&quot;        &quot;displ&quot;        &quot;year&quot;        
##  [5] &quot;cyl&quot;          &quot;trans&quot;        &quot;drv&quot;          &quot;cty&quot;         
##  [9] &quot;hwy&quot;          &quot;fl&quot;           &quot;class&quot;</code></pre>
<p>To access one of the variables as a vector, we use the <code>$</code> operator.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mpg$year</code></pre></div>
<pre><code>##   [1] 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 2008 1999 1999 2008
##  [15] 2008 1999 2008 2008 2008 2008 2008 1999 2008 1999 1999 2008 2008 2008
##  [29] 2008 2008 1999 1999 1999 2008 1999 2008 2008 1999 1999 1999 1999 2008
##  [43] 2008 2008 1999 1999 2008 2008 2008 2008 1999 1999 2008 2008 2008 1999
##  [57] 1999 1999 2008 2008 2008 1999 2008 1999 2008 2008 2008 2008 2008 2008
##  [71] 1999 1999 2008 1999 1999 1999 2008 1999 1999 1999 2008 2008 1999 1999
##  [85] 1999 1999 1999 2008 1999 2008 1999 1999 2008 2008 1999 1999 2008 2008
##  [99] 2008 1999 1999 1999 1999 1999 2008 2008 2008 2008 1999 1999 2008 2008
## [113] 1999 1999 2008 1999 1999 2008 2008 2008 2008 2008 2008 2008 1999 1999
## [127] 2008 2008 2008 2008 1999 2008 2008 1999 1999 1999 2008 1999 2008 2008
## [141] 1999 1999 1999 2008 2008 2008 2008 1999 1999 2008 1999 1999 2008 2008
## [155] 1999 1999 1999 2008 2008 1999 1999 2008 2008 2008 2008 1999 1999 1999
## [169] 1999 2008 2008 2008 2008 1999 1999 1999 1999 2008 2008 1999 1999 2008
## [183] 2008 1999 1999 2008 1999 1999 2008 2008 1999 1999 2008 1999 1999 1999
## [197] 2008 2008 1999 2008 1999 1999 2008 1999 1999 2008 2008 1999 1999 2008
## [211] 2008 1999 1999 1999 1999 2008 2008 2008 2008 1999 1999 1999 1999 1999
## [225] 1999 2008 2008 1999 1999 2008 2008 1999 1999 2008</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mpg$hwy</code></pre></div>
<pre><code>##   [1] 29 29 31 30 26 26 27 26 25 28 27 25 25 25 25 24 25 23 20 15 20 17 17
##  [24] 26 23 26 25 24 19 14 15 17 27 30 26 29 26 24 24 22 22 24 24 17 22 21
##  [47] 23 23 19 18 17 17 19 19 12 17 15 17 17 12 17 16 18 15 16 12 17 17 16
##  [70] 12 15 16 17 15 17 17 18 17 19 17 19 19 17 17 17 16 16 17 15 17 26 25
##  [93] 26 24 21 22 23 22 20 33 32 32 29 32 34 36 36 29 26 27 30 31 26 26 28
## [116] 26 29 28 27 24 24 24 22 19 20 17 12 19 18 14 15 18 18 15 17 16 18 17
## [139] 19 19 17 29 27 31 32 27 26 26 25 25 17 17 20 18 26 26 27 28 25 25 24
## [162] 27 25 26 23 26 26 26 26 25 27 25 27 20 20 19 17 20 17 29 27 31 31 26
## [185] 26 28 27 29 31 31 26 26 27 30 33 35 37 35 15 18 20 20 22 17 19 18 20
## [208] 29 26 29 29 24 44 29 26 29 29 29 29 23 24 44 41 29 26 28 29 29 29 28
## [231] 29 26 26 26</code></pre>
<p>We can use the <code>dim()</code>, <code>nrow()</code> and <code>ncol()</code> functions to obtain information about the dimension of the data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(mpg)</code></pre></div>
<pre><code>## [1] 234  11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(mpg)</code></pre></div>
<pre><code>## [1] 234</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(mpg)</code></pre></div>
<pre><code>## [1] 11</code></pre>
<p>Here <code>nrow()</code> is also the number of observations, which in most cases is the <em>sample size</em>.</p>
<p>Subsetting data frames can work much like subsetting matrices using square brackets, <code>[,]</code>. Here, we find fuel efficient vehicles earning over 35 miles per gallon and only display <code>manufacturer</code>, <code>model</code> and <code>year</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mpg[mpg$hwy &gt;<span class="st"> </span><span class="dv">35</span>, <span class="kw">c</span>(<span class="st">&quot;manufacturer&quot;</span>, <span class="st">&quot;model&quot;</span>, <span class="st">&quot;year&quot;</span>)]</code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   manufacturer      model  year
##          &lt;chr&gt;      &lt;chr&gt; &lt;int&gt;
## 1        honda      civic  2008
## 2        honda      civic  2008
## 3       toyota    corolla  2008
## 4   volkswagen      jetta  1999
## 5   volkswagen new beetle  1999
## 6   volkswagen new beetle  1999</code></pre>
<p>An alternative would be to use the <code>subset()</code> function, which has a much more readable syntax.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">subset</span>(mpg, <span class="dt">subset =</span> hwy &gt;<span class="st"> </span><span class="dv">35</span>, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;manufacturer&quot;</span>, <span class="st">&quot;model&quot;</span>, <span class="st">&quot;year&quot;</span>))</code></pre></div>
<p>Lastly, we could use the <code>filter</code> and <code>select</code> functions from the <code>dplyr</code> package which introduces the <code>%&gt;%</code> operator from the <code>magrittr</code> package. This is not necessary for this course, however the <code>dplyr</code> package is something you should be aware of as it is becoming a popular tool in the <code>R</code> world.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
mpg %&gt;%<span class="st"> </span><span class="kw">filter</span>(hwy &gt;<span class="st"> </span><span class="dv">35</span>) %&gt;%<span class="st"> </span><span class="kw">select</span>(manufacturer, model, year)</code></pre></div>
<p>All three approaches produce the same results. Which you use will be largely based on a given situation as well as user preference.</p>
</div>
<div id="plotting" class="section level3">
<h3><span class="header-section-number">2.2.9</span> Plotting</h3>
<p>Now that we have some data to work with, and we have learned about the data at the most basic level, our next tasks is to visualize the data. Often, a proper visualization can illuminate features of the data that can inform further analysis.</p>
<p>We will look at three methods of visualizing data that we will use throughout the course:</p>
<ul>
<li>Histograms</li>
<li>Boxplots</li>
<li>Scatterplots</li>
</ul>
<div id="histograms" class="section level4">
<h4><span class="header-section-number">2.2.9.1</span> Histograms</h4>
<p>When visualizing a single numerical variable, a <strong>histogram</strong> will be our go-to tool, which can be created in <code>R</code> using the <code>hist()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mpg$cty)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>The histogram function has a number of parameters which can be changed to make our plot look much nicer. Use the <code>?</code> operator to read the documentation for the <code>hist()</code> to see a full list of these parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mpg$cty,
     <span class="dt">xlab   =</span> <span class="st">&quot;Miles Per Gallon (City)&quot;</span>,
     <span class="dt">main   =</span> <span class="st">&quot;Histogram of MPG (City)&quot;</span>,
     <span class="dt">breaks =</span> <span class="dv">12</span>,
     <span class="dt">col    =</span> <span class="st">&quot;dodgerblue&quot;</span>,
     <span class="dt">border =</span> <span class="st">&quot;darkorange&quot;</span>)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>Importantly, you should always be sure to label your axes and give the plot a title. The argument <code>breaks</code> is specific to <code>hist()</code>. Entering an integer will give a suggestion to <code>R</code> for how many bars to use for the histogram. By default <code>R</code> will attempt to intelligently guess a good number of <code>breaks</code>, but as we can see here, it is sometimes useful to modify this yourself.</p>
</div>
<div id="boxplots" class="section level4">
<h4><span class="header-section-number">2.2.9.2</span> Boxplots</h4>
<p>To visualize the relationship between a numerical and categorical variable, we will use a <strong>boxplot</strong>. In the <code>mpg</code> dataset, the <code>drv</code> variable takes a small, finite number of values. A car can only be front wheel drive, 4 wheel drive, or rear wheel drive.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(mpg$drv)</code></pre></div>
<pre><code>## [1] &quot;f&quot; &quot;4&quot; &quot;r&quot;</code></pre>
<p>First note that we can use a single boxplot as an alternative to a histogram for visualizing a single numerical variable. To do so in <code>R</code>, we use the <code>boxplot()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(mpg$hwy)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>However, more often we will use boxplots to compare a numerical variable for different values of a categorical variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(hwy ~<span class="st"> </span>drv, <span class="dt">data =</span> mpg)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>Here used the <code>boxplot()</code> command to create side-by-side boxplots. However, since we are now dealing with two variables, the syntax has changed. The <code>R</code> syntax <code>hwy ~ drv, data = mpg</code> reads “Plot the <code>hwy</code> variable against the <code>drv</code> variable using the dataset <code>mpg</code>.” We see the use of a <code>~</code> (which specifies a formula) and also a <code>data =</code> argument. This will be a syntax that is common to many functions we will use in this course.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(hwy ~<span class="st"> </span>drv, <span class="dt">data =</span> mpg,
     <span class="dt">xlab   =</span> <span class="st">&quot;Drivetrain (f = FWD, r = RWD, 4 = 4WD)&quot;</span>,
     <span class="dt">ylab   =</span> <span class="st">&quot;Miles Per Gallon (Highway)&quot;</span>,
     <span class="dt">main   =</span> <span class="st">&quot;MPG (Highway) vs Drivetrain&quot;</span>,
     <span class="dt">pch    =</span> <span class="dv">20</span>,
     <span class="dt">cex    =</span> <span class="dv">2</span>,
     <span class="dt">col    =</span> <span class="st">&quot;darkorange&quot;</span>,
     <span class="dt">border =</span> <span class="st">&quot;dodgerblue&quot;</span>)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>Again, <code>boxplot()</code> has a number of additional arguments which have the ability to make our plot more visually appealing.</p>
</div>
<div id="scatterplots" class="section level4">
<h4><span class="header-section-number">2.2.9.3</span> Scatterplots</h4>
<p>Lastly, to visualize the relationship between two numeric variables we will use a <strong>scatterplot</strong>. This can be done with the <code>plot()</code> function and the <code>~</code> syntax we just used with a boxplot. (The function <code>plot()</code> can also be used more generally; see the documentation for details.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(hwy ~<span class="st"> </span>displ, <span class="dt">data =</span> mpg)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(hwy ~<span class="st"> </span>displ, <span class="dt">data =</span> mpg,
     <span class="dt">xlab =</span> <span class="st">&quot;Engine Displacement (in Liters)&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Miles Per Gallon (Highway)&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;MPG (Highway) vs Engine Displacement&quot;</span>,
     <span class="dt">pch  =</span> <span class="dv">20</span>,
     <span class="dt">cex  =</span> <span class="dv">2</span>,
     <span class="dt">col  =</span> <span class="st">&quot;dodgerblue&quot;</span>)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
</div>
<div id="distributions-1" class="section level3">
<h3><span class="header-section-number">2.2.10</span> Distributions</h3>
<p>When working with different statistical distributions, we often want to make probabilistic statements based on the distribution.</p>
<p>We typically want to know one of four things:</p>
<ul>
<li>The density (pdf) at a particular value.</li>
<li>The distribution (cdf) at a particular value.</li>
<li>The quantile value corresponding to a particular probability.</li>
<li>A random draw of values from a particular distribution.</li>
</ul>
<p>This used to be done with statistical tables printed in the back of textbooks. Now, <code>R</code> has functions for obtaining density, distribution, quantile and random values.</p>
<p>The general naming structure of the relevant <code>R</code> functions is:</p>
<ul>
<li><code>dname</code> calculates density (pdf) at input <code>x</code>.</li>
<li><code>pname</code> calculates distribution (cdf) at input <code>x</code>.</li>
<li><code>qname</code> calculates the quantile at an input probability.</li>
<li><code>rname</code> generates a random draw from a particular distribution.</li>
</ul>
<p>Note that <code>name</code> represents the name of the given distribution.</p>
<p>For example, consider a random variable <span class="math inline">\(X\)</span> which is <span class="math inline">\(N(\mu = 2, \sigma^2 = 25)\)</span>. (Note, we are parameterizing using the variance <span class="math inline">\(\sigma^2\)</span>. <code>R</code> however uses the standard deviation.)</p>
<p>To calculate the value of the pdf at <code>x = 3</code>, that is, the height of the curve at <code>x = 3</code>, use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dnorm</span>(<span class="dt">x =</span> <span class="dv">3</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 0.07820854</code></pre>
<p>To calculate the value of the cdf at <code>x = 3</code>, that is, <span class="math inline">\(P(X \leq 3)\)</span>, the probability that <span class="math inline">\(X\)</span> is less than or equal to <code>3</code>, use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">3</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 0.5792597</code></pre>
<p>Or, to calculate the quantile for probability 0.975, use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.975</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 11.79982</code></pre>
<p>Lastly, to generate a random sample of size <code>n = 10</code>, use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>##  [1]  0.9334536 -1.9989346  4.2243627  2.1341861 -1.2723362  4.4703965
##  [7]  6.1559593  8.4572915  0.5883718  9.3614052</code></pre>
<p>These functions exist for many other distributions, including but not limited to:</p>
<table>
<thead>
<tr class="header">
<th align="left">Command</th>
<th align="left">Distribution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>*binom</code></td>
<td align="left">Binomial</td>
</tr>
<tr class="even">
<td align="left"><code>*t</code></td>
<td align="left">t</td>
</tr>
<tr class="odd">
<td align="left"><code>*pois</code></td>
<td align="left">Poisson</td>
</tr>
<tr class="even">
<td align="left"><code>*f</code></td>
<td align="left">F</td>
</tr>
<tr class="odd">
<td align="left"><code>*chisq</code></td>
<td align="left">Chi-Squared</td>
</tr>
</tbody>
</table>
<p>Where <code>*</code> can be <code>d</code>, <code>p</code>, <code>q</code>, and <code>r</code>. Each distribution will have its own set of parameters which need to be passed to the functions as arguments. For example, <code>dbinom()</code> would not have arguments for <code>mean</code> and <code>sd</code>, since those are not parameters of the distribution. Instead a binomial distribution is usually parameterized by <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>, however <code>R</code> chooses to call them something else. To find the names that <code>R</code> uses we would use <code>?dbinom</code> and see that <code>R</code> instead calls the arguments <code>size</code> and <code>prob</code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbinom</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="fl">0.75</span>)</code></pre></div>
<pre><code>## [1] 0.145998</code></pre>
<p>Also note that, when using the <code>dname</code> functions with discrete distributions, they are the pmf of the distribution. For example, the above command is <span class="math inline">\(P(Y = 6)\)</span> if <span class="math inline">\(Y \sim b(n = 10, p = 0.75)\)</span>. (The probability of flipping an unfair coin <code>10</code> times and seeing <code>6</code> heads, if the probability of heads is <code>0.75</code>.)</p>
</div>
</div>
<div id="programming-basics" class="section level2">
<h2><span class="header-section-number">2.3</span> Programming Basics</h2>
<div id="logical-operators" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Logical Operators</h3>
<table style="width:94%;">
<colgroup>
<col width="15%" />
<col width="33%" />
<col width="33%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Summary</th>
<th align="left">Example</th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>x &lt; y</code></td>
<td align="left"><code>x</code> less than <code>y</code></td>
<td align="left"><code>3 &lt; 42</code></td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left"><code>x &gt; y</code></td>
<td align="left"><code>x</code> greater than <code>y</code></td>
<td align="left"><code>3 &gt; 42</code></td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left"><code>x &lt;= y</code></td>
<td align="left"><code>x</code> less than or equal to <code>y</code></td>
<td align="left"><code>3 &lt;= 42</code></td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left"><code>x &gt;= y</code></td>
<td align="left"><code>x</code> greater than or equal to <code>y</code></td>
<td align="left"><code>3 &gt;= 42</code></td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left"><code>x == y</code></td>
<td align="left"><code>x</code>equal to <code>y</code></td>
<td align="left"><code>3 == 42</code></td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left"><code>x != y</code></td>
<td align="left"><code>x</code> not equal to <code>y</code></td>
<td align="left"><code>3 != 42</code></td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left"><code>!x</code></td>
<td align="left">not <code>x</code></td>
<td align="left"><code>!(3 &gt; 42)</code></td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left"><code>x | y</code></td>
<td align="left"><code>x</code> or <code>y</code></td>
<td align="left"><code>(3 &gt; 42) | TRUE</code></td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left"><code>x &amp; y</code></td>
<td align="left"><code>x</code> and <code>y</code></td>
<td align="left"><code>(3 &lt; 4) &amp; ( 42 &gt; 13)</code></td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>In <code>R</code>, logical operators are vectorized. To demonstrate this, we will use the following height and weight data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights =<span class="st"> </span><span class="kw">c</span>(<span class="dv">110</span>, <span class="dv">120</span>, <span class="dv">115</span>, <span class="dv">136</span>, <span class="dv">205</span>, <span class="dv">156</span>, <span class="dv">175</span>)
weights =<span class="st"> </span><span class="kw">c</span>(<span class="dv">64</span>, <span class="dv">67</span>, <span class="dv">62</span>, <span class="dv">60</span>, <span class="dv">77</span>, <span class="dv">70</span>, <span class="dv">66</span>)</code></pre></div>
<p>First, using the <code>&lt;</code> operator, when can find which <code>heights</code> are less than <code>121</code>. Further, we could also find which <code>heights</code> are less than <code>121</code> or exactly equal to <code>156.</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights &lt;<span class="st"> </span><span class="dv">121</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights &lt;<span class="st"> </span><span class="dv">121</span> |<span class="st"> </span>heights ==<span class="st"> </span><span class="dv">156</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE  TRUE FALSE</code></pre>
<p>Often, a vector of logical values is useful for subsetting a vector. For example, we can find the <code>heights</code> that are larger than <code>150</code>. We can then use the resulting vector to subset the <code>heights</code> vector, thus actually returning the <code>heights</code> that are above <code>150</code>, instead of a vector of which values are above <code>150</code>. Here we also obtain the <code>weights</code> corresponding to <code>heights</code> above <code>150</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights &gt;<span class="st"> </span><span class="dv">150</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights[heights &gt;<span class="st"> </span><span class="dv">150</span>]</code></pre></div>
<pre><code>## [1] 205 156 175</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weights[heights &gt;<span class="st"> </span><span class="dv">150</span>]</code></pre></div>
<pre><code>## [1] 77 70 66</code></pre>
<p>When comparing vectors, be sure you are comparing vectors of the same length.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a =<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>
b =<span class="st"> </span><span class="dv">2</span>:<span class="dv">4</span>
a &lt;<span class="st"> </span>b</code></pre></div>
<pre><code>## Warning in a &lt; b: longer object length is not a multiple of shorter object
## length</code></pre>
<pre><code>##  [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>What happened here? <code>R</code> still performed the operation, but it also gives us a warning. (To perform the operation, <code>R</code> automatically made <code>b</code> longer by repeating <code>b</code> as needed.)</p>
<p>The one exception to this behavior is comparing to a vector of length <code>1</code>. <code>R</code> does not warn us in this case, as comparing each value of a vector to a single value is a common operation that is usually reasonable to perform.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &gt;<span class="st"> </span><span class="dv">5</span></code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>Often we will want to convert <code>TRUE</code> and <code>FALSE</code> values to <code>1</code> and <code>0</code>. When performing mathematical operations on <code>TRUE</code> and <code>FALSE</code>, this is done automatically through type coercion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">5</span> +<span class="st"> </span>(a &gt;<span class="st"> </span><span class="dv">5</span>)</code></pre></div>
<pre><code>##  [1] 5 5 5 5 5 6 6 6 6 6</code></pre>
<p>By calling <code>sum()</code> on a vector of logical values, we can essentially count the number of <code>TRUE</code> values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(a &gt;<span class="st"> </span><span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Here we count the elements of <code>a</code> that are larger than <code>5.</code> This is an extremely useful feature.</p>
</div>
<div id="control-flow" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Control Flow</h3>
<p>In <code>R</code>, the if/else syntax is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (...) {
  some R code
} else {
  more R code
}</code></pre></div>
<p>For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="dv">1</span>
y =<span class="st"> </span><span class="dv">3</span>
if (x &gt;<span class="st"> </span>y) {
  z =<span class="st"> </span>x *<span class="st"> </span>y
  <span class="kw">print</span>(<span class="st">&quot;x is larger than y&quot;</span>)
} else {
  z =<span class="st"> </span>x +<span class="st"> </span><span class="dv">5</span> *<span class="st"> </span>y
  <span class="kw">print</span>(<span class="st">&quot;x is less than or equal to y&quot;</span>)
}</code></pre></div>
<pre><code>## [1] &quot;x is less than or equal to y&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z</code></pre></div>
<pre><code>## [1] 16</code></pre>
<p><code>R</code> also has a special function <code>ifelse()</code> which is very useful. It returns one of two specified values based on a conditional statement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ifelse</span>(<span class="dv">4</span> &gt;<span class="st"> </span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>The real power of <code>ifelse()</code> comes from its ability to be applied to vectors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fib =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">21</span>)
<span class="kw">ifelse</span>(fib &gt;<span class="st"> </span><span class="dv">6</span>, <span class="st">&quot;Foo&quot;</span>, <span class="st">&quot;Bar&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;Bar&quot; &quot;Bar&quot; &quot;Bar&quot; &quot;Bar&quot; &quot;Bar&quot; &quot;Foo&quot; &quot;Foo&quot; &quot;Foo&quot;</code></pre>
<p>Now a <code>for</code> loop example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="dv">11</span>:<span class="dv">15</span>
for (i in <span class="dv">1</span>:<span class="dv">5</span>) {
  x[i] =<span class="st"> </span>x[i] *<span class="st"> </span><span class="dv">2</span>
}

x</code></pre></div>
<pre><code>## [1] 22 24 26 28 30</code></pre>
<p>Note that this <code>for</code> loop is very normal in many programming languages, but not in <code>R</code>. In <code>R</code> we would not use a loop, instead we would simply use a vectorized operation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="dv">11</span>:<span class="dv">15</span>
x =<span class="st"> </span>x *<span class="st"> </span><span class="dv">2</span>
x</code></pre></div>
<pre><code>## [1] 22 24 26 28 30</code></pre>
</div>
<div id="functions" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Functions</h3>
<p>So far we have been using functions, but haven’t actually discussed some of their details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">function_name</span>(<span class="dt">arg1 =</span> <span class="dv">10</span>, <span class="dt">arg2 =</span> <span class="dv">20</span>)</code></pre></div>
<p>To use a function, you simply type its name, followed by an open parenthesis, then specify values of its arguments, then finish with a closing parenthesis.</p>
<p>An <strong>argument</strong> is a variable which is used in the body of the function. Specifying the values of the arguments is essentially providing the inputs to the function.</p>
<p>We can also write our own functions in <code>R</code>. For example, we often like to “standardize” variables, that is, subtracting the sample mean, and dividing by the sample standard deviation.</p>
<p><span class="math display">\[
\frac{x - \bar{x}}{s}
\]</span></p>
<p>In <code>R</code> we would write a function to do this. When writing a function, there are three thing you must do.</p>
<ul>
<li>Give the function a name. Preferably something that is short, but descriptive.</li>
<li>Specify the arguments using <code>function()</code></li>
<li>Write the body of the function within curly braces, <code>{}</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">standardize =<span class="st"> </span>function(x) {
  m =<span class="st"> </span><span class="kw">mean</span>(x)
  std =<span class="st"> </span><span class="kw">sd</span>(x)
  result =<span class="st"> </span>(x -<span class="st"> </span>m) /<span class="st"> </span>std
  result
}</code></pre></div>
<p>Here the name of the function is <code>standardize</code>, and the function has a single argument <code>x</code> which is used in the body of function. Note that the output of the final line of the body is what is returned by the function. In this case the function returns the vector stored in the variable <code>results</code>.</p>
<p>To test our function, we will take a random sample of size <code>n = 10</code> from a normal distribution with a mean of <code>2</code> and a standard deviation of <code>5</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">test_sample =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>))</code></pre></div>
<pre><code>##  [1] -2.239447  8.172457 12.072851  6.752696  4.107831 -5.155550  1.154702
##  [8] -1.801945  9.174531 10.319363</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">standardize</span>(<span class="dt">x =</span> test_sample)</code></pre></div>
<pre><code>##  [1] -1.08802290  0.65609538  1.30945798  0.41826845 -0.02477797
##  [6] -1.57650489 -0.51946241 -1.01473608  0.82395470  1.01572774</code></pre>
<p>This function could be written much more succinctly, simply performing all the operations on one line and immediately returning the result, without storing any of the intermediate results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">standardize =<span class="st"> </span>function(x) {
  (x -<span class="st"> </span><span class="kw">mean</span>(x)) /<span class="st"> </span><span class="kw">sd</span>(x)
}</code></pre></div>
<p>When specifying arguments, you can provide default arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power_of_num =<span class="st"> </span>function(num, <span class="dt">power =</span> <span class="dv">2</span>) {
  num ^<span class="st"> </span>power
}</code></pre></div>
<p>Let’s look at a number of ways that we could run this function to perform the operation <code>10^2</code> resulting in <code>100</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_of_num</span>(<span class="dv">10</span>)</code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_of_num</span>(<span class="dv">10</span>, <span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_of_num</span>(<span class="dt">num =</span> <span class="dv">10</span>, <span class="dt">power =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_of_num</span>(<span class="dt">power =</span> <span class="dv">2</span>, <span class="dt">num =</span> <span class="dv">10</span>)</code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>Note that without using the argument names, the order matters. The following code will not evaluate to the same output as the previous example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_of_num</span>(<span class="dv">2</span>, <span class="dv">10</span>)</code></pre></div>
<pre><code>## [1] 1024</code></pre>
<p>Also, the following line of code would produce an error since arguments without a default value must be specified.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_of_num</span>(<span class="dt">power =</span> <span class="dv">5</span>)</code></pre></div>
<p>To further illustrate a function with a default argument, we will write a function that calculates sample variance two ways.</p>
<p>By default, is will calculate the unbiased estimate of <span class="math inline">\(\sigma^2\)</span>, which we will call <span class="math inline">\(s^2\)</span>.</p>
<p><span class="math display">\[
s^2 = \frac{1}{n - 1}\sum_{i=1}^{n}(x - \bar{x})^2
\]</span></p>
<p>It will also have the ability to return the biased estimate (based on maximum likelihood) which we will call <span class="math inline">\(\hat{\sigma}^2\)</span>.</p>
<p><span class="math display">\[
\hat{\sigma}^2 = \frac{1}{n}\sum_{i=1}^{n}(x - \bar{x})^2
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get_var =<span class="st"> </span>function(x, <span class="dt">biased =</span> <span class="ot">FALSE</span>) {
  n =<span class="st"> </span><span class="kw">length</span>(x) -<span class="st"> </span><span class="dv">1</span> *<span class="st"> </span>!biased
  (<span class="dv">1</span> /<span class="st"> </span>n) *<span class="st"> </span><span class="kw">sum</span>((x -<span class="st"> </span><span class="kw">mean</span>(x)) ^<span class="st"> </span><span class="dv">2</span>)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_var</span>(test_sample)</code></pre></div>
<pre><code>## [1] 35.6376</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_var</span>(test_sample, <span class="dt">biased =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## [1] 35.6376</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(test_sample)</code></pre></div>
<pre><code>## [1] 35.6376</code></pre>
<p>We see the function is working as expected, and when returning the unbiased estimate it matches <code>R</code>’s built in function <code>var()</code>. Finally, let’s examine the biased estimate of <span class="math inline">\(\sigma^2\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_var</span>(test_sample, <span class="dt">biased =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 32.07384</code></pre>
</div>
</div>
<div id="hypothesis-tests-in-r" class="section level2">
<h2><span class="header-section-number">2.4</span> Hypothesis Tests in <code>R</code></h2>
<p>A prerequisite for STAT 420 is an understanding of the basics of hypothesis testing. Recall the basic structure of hypothesis tests:</p>
<ul>
<li>An overall model and related assumptions are made. (The most common being observations following a normal distribution.)</li>
<li>The <strong>null</strong> (<span class="math inline">\(H_{0}\)</span>) and <strong>alternative</strong> (<span class="math inline">\(H_{1}\)</span> or <span class="math inline">\(H_{A}\)</span>) hypothesis are specified. Usually the null specifies a particular value of a parameter.</li>
<li>With given data, the <strong>value</strong> of the <em>test statistic</em> is calculated.</li>
<li>Under the general assumptions, as well as assuming the null hypothesis is true, the <strong>distribution</strong> of the <em>test statistic</em> is known.</li>
<li>Given the distribution and value of the test statistic, as well as the form of the alternative hypothesis, we can calculate a <strong>p-value</strong> of the test.</li>
<li>Based on the <strong>p-value</strong> and pre-specified level of significance, we make a decision. One of:
<ul>
<li>Fail to reject the null hypothesis.</li>
<li>Reject the null hypothesis.</li>
</ul></li>
</ul>
<p>We’ll do some quick review of two of the most common tests to show how they are performed using <code>R</code>.</p>
<div id="one-sample-t-test-review" class="section level3">
<h3><span class="header-section-number">2.4.1</span> One Sample t-Test: Review</h3>
<p>Suppose <span class="math inline">\(x_{i} \sim \mathrm{N}(\mu,\sigma^{2})\)</span> and we want to test <span class="math inline">\(H_{0}: \mu = \mu_{0}\)</span> versus <span class="math inline">\(H_{1}: \mu \neq \mu_{0}.\)</span></p>
<p>Assuming <span class="math inline">\(\sigma\)</span> is unknown, we use the one-sample Student’s <span class="math inline">\(t\)</span> test statistic:</p>
<p><span class="math display">\[
t = \frac{\bar{x}-\mu_{0}}{s/\sqrt{n}} \sim t_{n-1},
\]</span></p>
<p>where <span class="math inline">\(\bar{x} = \displaystyle\frac{\sum_{i=1}^{n}x_{i}}{n}\)</span> and <span class="math inline">\(s = \sqrt{\displaystyle\frac{1}{n - 1}\sum_{i=1}^{n}(x_i - \bar{x})^2}\)</span>.</p>
<p>A <span class="math inline">\(100(1 - \alpha)\)</span>% confidence interval for <span class="math inline">\(\mu\)</span> is given by,</p>
<p><span class="math display">\[
\bar{x} \pm t_{n-1}(\alpha/2)\frac{s}{\sqrt{n}}
\]</span></p>
<p>where <span class="math inline">\(t_{n-1}(\alpha/2)\)</span> is the critical value such that <span class="math inline">\(P\left(t&gt;t_{n-1}(\alpha/2)\right) = \alpha/2\)</span> for <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</div>
<div id="one-sample-t-test-example" class="section level3">
<h3><span class="header-section-number">2.4.2</span> One Sample t-Test: Example</h3>
<p>Suppose a grocery store sells “16 ounce” boxes of <em>Captain Crisp</em> cereal. A random sample of 9 boxes was taken and weighed. The weight in ounces are stored in the data frame <code>capt_crisp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">capt_crisp =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">weight =</span> <span class="kw">c</span>(<span class="fl">15.5</span>, <span class="fl">16.2</span>, <span class="fl">16.1</span>, <span class="fl">15.8</span>, <span class="fl">15.6</span>, <span class="fl">16.0</span>, <span class="fl">15.8</span>, <span class="fl">15.9</span>, <span class="fl">16.2</span>))</code></pre></div>
<p>The company that makes <em>Captain Crisp</em> cereal claims that the average weight of a box is at least 16 ounces. We will assume the weight of cereal in a box is normally distributed and use a 0.05 level of significance to test the company’s claim.</p>
<p>To test <span class="math inline">\(H_{0}: \mu \geq 16\)</span> versus <span class="math inline">\(H_{1}: \mu &lt; 16\)</span>, the test statistic is</p>
<p><span class="math display">\[
t = \frac{\bar{x} - \mu_{0}}{s / \sqrt{n}}
\]</span></p>
<p>The sample mean <span class="math inline">\(\bar{x}\)</span> and the sample standard deviation <span class="math inline">\(s\)</span> can be easily computed using <code>R</code>. We also create variables which store the hypothesized mean and the sample size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x_bar =<span class="st"> </span><span class="kw">mean</span>(capt_crisp$weight)
s     =<span class="st"> </span><span class="kw">sd</span>(capt_crisp$weight)
mu_0  =<span class="st"> </span><span class="dv">16</span>
n     =<span class="st"> </span><span class="dv">9</span></code></pre></div>
<p>We can then easily compute the test statistic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t =<span class="st"> </span>(x_bar -<span class="st"> </span>mu_0) /<span class="st"> </span>(s /<span class="st"> </span><span class="kw">sqrt</span>(n))
t</code></pre></div>
<pre><code>## [1] -1.2</code></pre>
<p>Under the null hypothesis, the test statistic has a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n - 1\)</span> degrees of freedom, in this case 8.</p>
<p>To complete the test, we need to obtain the p-value of the test. Since this is a one-sided test with a less-than alternative, we need to area to the left of -1.2 for a <span class="math inline">\(t\)</span> distribution with 8 degrees of freedom. That is,</p>
<p><span class="math display">\[
P(t_{8} &lt; -1.2)
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pt</span>(t, <span class="dt">df =</span> n -<span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 0.1322336</code></pre>
<p>We now have the p-value of our test, which is greater than our significance level (0.05), so we fail to reject the null hypothesis.</p>
<p>Alternatively, this entire process could have been completed using one line of <code>R</code> code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(<span class="dt">x =</span> capt_crisp$weight, <span class="dt">mu =</span> <span class="dv">16</span>, <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;less&quot;</span>), <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  capt_crisp$weight
## t = -1.2, df = 8, p-value = 0.1322
## alternative hypothesis: true mean is less than 16
## 95 percent confidence interval:
##      -Inf 16.05496
## sample estimates:
## mean of x 
##      15.9</code></pre>
<p>We supply <code>R</code> with the data, the hypothesized value of <span class="math inline">\(\mu\)</span>, the alternative, and the confidence level. <code>R</code> then returns a wealth of information including:</p>
<ul>
<li>The value of the test statistic.</li>
<li>The degrees of freedom of the distribution under the null hypothesis.</li>
<li>The p-value of the test.</li>
<li>The confidence interval which corresponds to the test.</li>
<li>An estimate of <span class="math inline">\(\mu\)</span>.</li>
</ul>
<p>Since the test was one-sided, <code>R</code> returned a one-sided confidence interval. If instead we wanted a two-sided interval for the mean weight of boxes of <em>Captain Crisp</em> cereal we could modify our code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">capt_test_results =<span class="st"> </span><span class="kw">t.test</span>(capt_crisp$weight, <span class="dt">mu =</span> <span class="dv">16</span>,
                           <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>), <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</code></pre></div>
<p>This time we have stored the results. By doing so, we can directly access portions of the output from <code>t.test()</code>. To see what information is available we use the <code>names()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(capt_test_results)</code></pre></div>
<pre><code>## [1] &quot;statistic&quot;   &quot;parameter&quot;   &quot;p.value&quot;     &quot;conf.int&quot;    &quot;estimate&quot;   
## [6] &quot;null.value&quot;  &quot;alternative&quot; &quot;method&quot;      &quot;data.name&quot;</code></pre>
<p>We are interested in the confidence interval which is stored in <code>conf.int</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">capt_test_results$conf.int</code></pre></div>
<pre><code>## [1] 15.70783 16.09217
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<p>Let’s check this interval “by hand.” The one piece of information we are missing is the critical value, <span class="math inline">\(t_{n-1}(\alpha/2) = t_{8}(0.025)\)</span>, which can be calculated in <code>R</code> using the <code>qt()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">8</span>)</code></pre></div>
<pre><code>## [1] 2.306004</code></pre>
<p>So, the 95% CI for the mean weight of a cereal box is calculated by plugging into the formula,</p>
<p><span class="math display">\[
\bar{x} \pm t_{n-1}(\alpha/2) \frac{s}{\sqrt{n}}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(capt_crisp$weight) -<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">8</span>) *<span class="st"> </span><span class="kw">sd</span>(capt_crisp$weight) /<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">9</span>),
  <span class="kw">mean</span>(capt_crisp$weight) +<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">8</span>) *<span class="st"> </span><span class="kw">sd</span>(capt_crisp$weight) /<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">9</span>))</code></pre></div>
<pre><code>## [1] 15.70783 16.09217</code></pre>
</div>
<div id="two-sample-t-test-review" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Two Sample t-Test: Review</h3>
<p>Suppose <span class="math inline">\(x_{i} \sim \mathrm{N}(\mu_{x}, \sigma^{2})\)</span> and <span class="math inline">\(y_{i} \sim \mathrm{N}(\mu_{y}, \sigma^{2}).\)</span></p>
<p>Want to test <span class="math inline">\(H_{0}: \mu_{x} - \mu_{y} = \mu_{0}\)</span> versus <span class="math inline">\(H_{1}: \mu_{x} - \mu_{y} \neq \mu_{0}.\)</span></p>
<p>Assuming <span class="math inline">\(\sigma\)</span> is unknown, use the two-sample Student’s <span class="math inline">\(t\)</span> test statistic:</p>
<p><span class="math display">\[
t = \frac{(\bar{x} - \bar{y})-\mu_{0}}{s_{p}\sqrt{\frac{1}{n}+\frac{1}{m}}} \sim t_{n+m-2},
\]</span></p>
<p>where <span class="math inline">\(\displaystyle\bar{x}=\frac{\sum_{i=1}^{n}x_{i}}{n}\)</span>, <span class="math inline">\(\displaystyle\bar{y}=\frac{\sum_{i=1}^{m}y_{i}}{m}\)</span>, and <span class="math inline">\(s_p^2 = \displaystyle\frac{(n-1)s_x^2+(m-1)s_y^2}{n+m-2}\)</span>.</p>
<p>A <span class="math inline">\(100(1-\alpha)\)</span>% CI for <span class="math inline">\(\mu_{x}-\mu_{y}\)</span> is given by</p>
<p><span class="math display">\[
(\bar{x} - \bar{y}) \pm t_{n+m-2}(\alpha/2) \left(s_{p}\textstyle\sqrt{\frac{1}{n}+\frac{1}{m}}\right),
\]</span></p>
<p>where <span class="math inline">\(t_{n+m-2}(\alpha/2)\)</span> is the critical value such that <span class="math inline">\(P\left(t&gt;t_{n+m-2}(\alpha/2)\right)=\alpha/2\)</span>.</p>
</div>
<div id="two-sample-t-test-example" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Two Sample t-Test: Example</h3>
<p>Assume that the distributions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are <span class="math inline">\(\mathrm{N}(\mu_{1},\sigma^{2})\)</span> and <span class="math inline">\(\mathrm{N}(\mu_{2},\sigma^{2})\)</span>, respectively. Given the <span class="math inline">\(n = 6\)</span> observations of <span class="math inline">\(X\)</span>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">82</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">94</span>, <span class="dv">82</span>)
n =<span class="st"> </span><span class="kw">length</span>(x)</code></pre></div>
<p>and the <span class="math inline">\(m = 8\)</span> observations of <span class="math inline">\(Y\)</span>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y =<span class="st"> </span><span class="kw">c</span>(<span class="dv">64</span>, <span class="dv">72</span>, <span class="dv">60</span>, <span class="dv">76</span>, <span class="dv">72</span>, <span class="dv">80</span>, <span class="dv">84</span>, <span class="dv">68</span>)
m =<span class="st"> </span><span class="kw">length</span>(y)</code></pre></div>
<p>we will test <span class="math inline">\(H_{0}: \mu_{1} = \mu_{2}\)</span> versus <span class="math inline">\(H_{1}: \mu_{1} &gt; \mu_{2}\)</span>.</p>
<p>First, note that we can calculate the sample means and standard deviations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x_bar =<span class="st"> </span><span class="kw">mean</span>(x)
s_x   =<span class="st"> </span><span class="kw">sd</span>(x)
y_bar =<span class="st"> </span><span class="kw">mean</span>(y)
s_y   =<span class="st"> </span><span class="kw">sd</span>(y)</code></pre></div>
<p>We can then calculate the pooled standard deviation.</p>
<p><span class="math display">\[
s_{p} = \sqrt{\frac{(n-1)s_{x}^{2}+(m-1)s_{y}^{2}}{n+m-2}}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s_p =<span class="st"> </span><span class="kw">sqrt</span>(((n -<span class="st"> </span><span class="dv">1</span>) *<span class="st"> </span>s_x ^<span class="st"> </span><span class="dv">2</span> +<span class="st"> </span>(m -<span class="st"> </span><span class="dv">1</span>) *<span class="st"> </span>s_y ^<span class="st"> </span><span class="dv">2</span>) /<span class="st"> </span>(n +<span class="st"> </span>m -<span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<p>Thus, the relevant <span class="math inline">\(t\)</span> test statistic is given by</p>
<p><span class="math display">\[
t = \frac{(\bar{x}-\bar{y})-\mu_{0}}{s_{p}\sqrt{\frac{1}{n}+\frac{1}{m}}}.
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t =<span class="st"> </span>((x_bar -<span class="st"> </span>y_bar) -<span class="st"> </span><span class="dv">0</span>) /<span class="st"> </span>(s_p *<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> /<span class="st"> </span>n +<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span>m))
t</code></pre></div>
<pre><code>## [1] 1.823369</code></pre>
<p>Note that <span class="math inline">\(t \sim t_{n + m - 2} = t_{12}\)</span>, so we can calculate the p-value, which is</p>
<p><span class="math display">\[
P(t_{12} &gt; 1.8233692).
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> -<span class="st"> </span><span class="kw">pt</span>(t, <span class="dt">df =</span> n +<span class="st"> </span>m -<span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.04661961</code></pre>
<p>But, then again, we could have simply performed this test in one line of <code>R</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(x, y, <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;greater&quot;</span>), <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  x and y
## t = 1.8234, df = 12, p-value = 0.04662
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  0.1802451       Inf
## sample estimates:
## mean of x mean of y 
##        80        72</code></pre>
<p>Recall that a two-sample <span class="math inline">\(t\)</span>-test can be done with or without an equal variance assumption. Here <code>var.equal = TRUE</code> tells <code>R</code> we would like to perform the test under the equal variance assumption.</p>
<p>Above we carried out the analysis using two vectors <code>x</code> and <code>y</code>. In general, we will have a preference for using data frames.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t_test_data =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">values =</span> <span class="kw">c</span>(x, y),
                         <span class="dt">group  =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="kw">length</span>(x)), <span class="kw">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="kw">length</span>(y))))</code></pre></div>
<p>We now have the data stored in a single variables (<code>values</code>) and have created a second variable (<code>group</code>) which indicates which “sample” the value belongs to.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t_test_data</code></pre></div>
<pre><code>##    values group
## 1      70     A
## 2      82     A
## 3      78     A
## 4      74     A
## 5      94     A
## 6      82     A
## 7      64     B
## 8      72     B
## 9      60     B
## 10     76     B
## 11     72     B
## 12     80     B
## 13     84     B
## 14     68     B</code></pre>
<p>Now to perform the test, we still use the <code>t.test()</code> function but with the <code>~</code> syntax and a <code>data</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(values ~<span class="st"> </span>group, <span class="dt">data =</span> t_test_data,
       <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;greater&quot;</span>), <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  values by group
## t = 1.8234, df = 12, p-value = 0.04662
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  0.1802451       Inf
## sample estimates:
## mean in group A mean in group B 
##              80              72</code></pre>
</div>
</div>
<div id="simulation" class="section level2">
<h2><span class="header-section-number">2.5</span> Simulation</h2>
<p>Simulation and model fitting are related but opposite processes.</p>
<ul>
<li>In <strong>simulation</strong>, the <em>data generating process</em> is known. We will know the form of the model as well as the value of each of the parameters. In particular, we will often control the distribution and parameters which define the randomness, or noise in the data.</li>
<li>In <strong>model fitting</strong>, the <em>data</em> is known. We will then assume a certain form of model and find the best possible values of the parameters given the observed data. Essentially we are seeking to uncover the truth. Often we will attempt to fit many models, and we will learn metrics to assess which model fits best.</li>
</ul>
<div class="figure">
<img src="images/simulation.png" alt="Simulation vs Modeling" />
<p class="caption">Simulation vs Modeling</p>
</div>
<p>Often we will simulate data according to a process we decide, then use a modeling method seen in class. We can then verify how well the method works, since we know the data generating process.</p>
<p>One of the biggest strengths of <code>R</code> is its ability to carry out simulations using built-in functions for generating random samples from certain distributions. We’ll look at two very simple examples here, however simulation will be a topic we revisit several times throughout the course.</p>
<div id="paired-differences" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Paired Differences</h3>
<p>Consider the model:</p>
<p><span class="math display">\[
\begin{split}
X_{11}, X_{12}, \ldots, X_{1n} \sim N(\mu_1,\sigma^2)\\
X_{21}, X_{22}, \ldots, X_{2n} \sim N(\mu_2,\sigma^2)
\end{split}
\]</span></p>
<p>Assume that <span class="math inline">\(\mu_1 = 6\)</span>, <span class="math inline">\(\mu_2 = 5\)</span>, <span class="math inline">\(\sigma^2 = 4\)</span> and <span class="math inline">\(n = 25\)</span>.</p>
<p>Let</p>
<p><span class="math display">\[
\begin{aligned}
\bar{X}_1 &amp;= \displaystyle\frac{1}{n}\sum_{i=1}^{n}X_{1i}\\
\bar{X}_2 &amp;= \displaystyle\frac{1}{n}\sum_{i=1}^{n}X_{2i}\\
D &amp;= \bar{X}_1 - \bar{X}_2.
\end{aligned}
\]</span></p>
<p>Suppose we would like to calculate <span class="math inline">\(P(0 &lt; D &lt; 2)\)</span>. First we will need to obtain the distribution of <span class="math inline">\(D\)</span>.</p>
<p>Recall,</p>
<p><span class="math display">\[
\bar{X}_1 \sim N\left(\mu_1,\frac{\sigma^2}{n}\right)
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\bar{X}_2 \sim N\left(\mu_2,\frac{\sigma^2}{n}\right).
\]</span></p>
<p>Then,</p>
<p><span class="math display">\[
D = \bar{X}_1 - \bar{X}_2 \sim N\left(\mu_1-\mu_2, \frac{\sigma^2}{n} + \frac{\sigma^2}{n}\right) = N\left(6-5, \frac{4}{25} + \frac{4}{25}\right).
\]</span></p>
<p>So,</p>
<p><span class="math display">\[
D \sim N(\mu = 1, \sigma^2 = 0.32).
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
P(0 &lt; D &lt; 2) = P(D &lt; 2) - P(D &lt; 0).
\]</span></p>
<p>This can then be calculated using <code>R</code> without a need to first standardize, or use a table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="dv">2</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="fl">0.32</span>)) -<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">0</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="fl">0.32</span>))</code></pre></div>
<pre><code>## [1] 0.9229001</code></pre>
<p>An alternative approach, would be to <strong>simulate</strong> a large number of observations of <span class="math inline">\(D\)</span> then use the <strong>empirical distribution</strong> to calculate the probability.</p>
<p>Our strategy will be to repeatedly:</p>
<ul>
<li>Generate a sample of 25 random observations from <span class="math inline">\(N(\mu_1 = 6,\sigma^2 = 4)\)</span>. Call the mean of this sample <span class="math inline">\(\bar{x}_{1s}\)</span>.</li>
<li>Generate a sample of 25 random observations from <span class="math inline">\(N(\mu_1 = 5,\sigma^2 = 4)\)</span>. Call the mean of this sample <span class="math inline">\(\bar{x}_{2s}\)</span>.</li>
<li>Calculate the differences of the means, <span class="math inline">\(d_s = \bar{x}_{1s} - \bar{x}_{2s}\)</span>.</li>
</ul>
<p>We will repeat the process a large number of times. Then we will use the distribution of the simulated observations of <span class="math inline">\(d_s\)</span> as an estimate for the true distribution of <span class="math inline">\(D\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
num_samples =<span class="st"> </span><span class="dv">10000</span>
differences =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, num_samples)</code></pre></div>
<p>Before starting our <code>for</code> loop to perform the operation, we set a seed for reproducibility, create and set a variable <code>num_samples</code> which will define the number of repetitions, and lastly create a variables <code>differences</code> which will store the simulate values, <span class="math inline">\(d_s\)</span>.</p>
<p>By using <code>set.seed()</code> we can reproduce the random results of <code>rnorm()</code> each time starting from that line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">for (s in <span class="dv">1</span>:num_samples) {
  x1 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">25</span>, <span class="dt">mean =</span> <span class="dv">6</span>, <span class="dt">sd =</span> <span class="dv">2</span>)
  x2 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">25</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">2</span>)
  differences[s] =<span class="st"> </span><span class="kw">mean</span>(x1) -<span class="st"> </span><span class="kw">mean</span>(x2)
}</code></pre></div>
<p>To estimate <span class="math inline">\(P(0 &lt; D &lt; 2)\)</span> we will find the proportion of values of <span class="math inline">\(d_s\)</span> (among the 10^{4} values of <span class="math inline">\(d_s\)</span> generated) that are between 0 and 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="dv">0</span> &lt;<span class="st"> </span>differences &amp;<span class="st"> </span>differences &lt;<span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.9222</code></pre>
<p>Recall that above we derived the distribution of <span class="math inline">\(D\)</span> to be <span class="math inline">\(N(\mu = 1, \sigma^2 = 0.32)\)</span></p>
<p>If we look at a histogram of the differences, we find that it looks very much like a normal distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(differences, <span class="dt">breaks =</span> <span class="dv">20</span>, 
     <span class="dt">main   =</span> <span class="st">&quot;Empirical Distribution of D&quot;</span>,
     <span class="dt">xlab   =</span> <span class="st">&quot;Simulated Values of D&quot;</span>,
     <span class="dt">col    =</span> <span class="st">&quot;dodgerblue&quot;</span>,
     <span class="dt">border =</span> <span class="st">&quot;darkorange&quot;</span>)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<p>Also the sample mean and variance are very close to to what we would expect.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(differences)</code></pre></div>
<pre><code>## [1] 1.001423</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(differences)</code></pre></div>
<pre><code>## [1] 0.3230183</code></pre>
<p>We could have also accomplished this task with a single line of more “idiomatic” <code>R</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
diffs =<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10000</span>, <span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dv">6</span>, <span class="dv">2</span>)) -<span class="st"> </span><span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dv">5</span>, <span class="dv">2</span>)))</code></pre></div>
<p>Use <code>?replicate</code> to take a look at the documentation for the <code>replicate</code> function and see if you can understand how this line performs the same operations that our <code>for</code> loop above executed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(differences ==<span class="st"> </span>diffs)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>We see that by setting the same seed for the randomization, we actually obtain identical results!</p>
</div>
<div id="distribution-of-a-sample-mean" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Distribution of a Sample Mean</h3>
<p>For another example of simulation, we will simulate observations from a Poisson distribution, and examine the empirical distribution of the sample mean of these observations.</p>
<p>Recall, if</p>
<p><span class="math display">\[
X \sim Pois(\mu)
\]</span></p>
<p>then</p>
<p><span class="math display">\[
E[X] = \mu
\]</span></p>
<p>and</p>
<p><span class="math display">\[
Var[X] = \mu.
\]</span></p>
<p>Also, recall that for a random variable <span class="math inline">\(X\)</span> with finite mean <span class="math inline">\(\mu\)</span> and finite variance <span class="math inline">\(\sigma^2\)</span>, the central limit theorem tells us that the mean, <span class="math inline">\(\bar{X}\)</span> of a random sample of size <span class="math inline">\(n\)</span> is approximately normal for <em>large</em> values of <span class="math inline">\(n\)</span>. Specifically, as <span class="math inline">\(n \to \infty\)</span>,</p>
<p><span class="math display">\[
\bar{X} \overset{d}{\to} N\left(\mu, \frac{\sigma^2}{n}\right).
\]</span></p>
<p>The following verifies this result for a Poisson distribution with <span class="math inline">\(\mu = 10\)</span> and a sample size of <span class="math inline">\(n = 50\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1337</span>)
mu          =<span class="st"> </span><span class="dv">10</span>
sample_size =<span class="st"> </span><span class="dv">50</span>
samples     =<span class="st"> </span><span class="dv">100000</span>
x_bars      =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, samples)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">for(i in <span class="dv">1</span>:samples){
  x_bars[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">rpois</span>(sample_size, <span class="dt">lambda =</span> mu))
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x_bar_hist =<span class="st"> </span><span class="kw">hist</span>(x_bars, <span class="dt">breaks =</span> <span class="dv">50</span>, 
                  <span class="dt">main =</span> <span class="st">&quot;Histogram of Sample Means&quot;</span>,
                  <span class="dt">xlab =</span> <span class="st">&quot;Sample Means&quot;</span>)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>Now we will compare sample statistics from the empirical distribution with their known values based on the parent distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(x_bars), mu)</code></pre></div>
<pre><code>## [1] 10.00008 10.00000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">var</span>(x_bars), mu /<span class="st"> </span>sample_size)</code></pre></div>
<pre><code>## [1] 0.1989732 0.2000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">sd</span>(x_bars), <span class="kw">sqrt</span>(mu) /<span class="st"> </span><span class="kw">sqrt</span>(sample_size))</code></pre></div>
<pre><code>## [1] 0.4460641 0.4472136</code></pre>
<p>And here, we will calculate the proportion of sample means that are within 2 standard deviations of the population mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(x_bars &gt;<span class="st"> </span>mu -<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span><span class="kw">sqrt</span>(mu) /<span class="st"> </span><span class="kw">sqrt</span>(sample_size) &amp;
<span class="st">     </span>x_bars &lt;<span class="st"> </span>mu +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span><span class="kw">sqrt</span>(mu) /<span class="st"> </span><span class="kw">sqrt</span>(sample_size))</code></pre></div>
<pre><code>## [1] 0.95429</code></pre>
<p>This last histogram uses a bit of a trick to approximately shade the bars that are within two standard deviations of the mean.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">shading =<span class="st"> </span><span class="kw">ifelse</span>(x_bar_hist$breaks &gt;<span class="st"> </span>mu -<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span><span class="kw">sqrt</span>(mu) /<span class="st"> </span><span class="kw">sqrt</span>(sample_size) &amp;<span class="st"> </span>
<span class="st">                   </span>x_bar_hist$breaks &lt;<span class="st"> </span>mu +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span><span class="kw">sqrt</span>(mu) /<span class="st"> </span><span class="kw">sqrt</span>(sample_size),
                  <span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>)

x_bar_hist =<span class="st"> </span><span class="kw">hist</span>(x_bars, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">col =</span> shading,
                  <span class="dt">main =</span> <span class="st">&quot;Histogram of Sample Means, Two Standard Deviations&quot;</span>,
                  <span class="dt">xlab =</span> <span class="st">&quot;Sample Means&quot;</span>)</code></pre></div>
<p><img src="02-r-intro_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probability-review.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rstudio-and-rmarkdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/daviddalpiaz/r4sl/edit/master/02-r-intro.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
